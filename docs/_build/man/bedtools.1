.TH "BEDTOOLS" "1" "July 21, 2012" "2.16.2" "bedtools"
.SH NAME
bedtools \- Bedtools Documentation
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.\" Man page generated from reStructeredText.
.
.sp
Brief paragraph of the software.
.SH OVERVIEW
.SS 1.1 Background
.sp
The development of BEDTools was motivated by a need for fast, flexible tools with which to compare large sets of genomic
features. Answering fundamental research questions with existing tools was either too slow or required modifications to the
way they reported or computed their results. We were aware of the utilities on the UCSC Genome Browser and Galaxy websites, as
well as the elegant tools available as part of Jim Kent’s monolithic suite of tools (“Kent source”). However, we found that
the web\-based tools were too cumbersome when working with large datasets generated by current sequencing technologies.
Similarly, we found that the Kent source command line tools often required a local installation of the UCSC Genome Browser.
These limitations, combined with the fact that we often wanted an extra option here or there that wasn’t available with
existing tools, led us to develop our own from scratch. The initial version of BEDTools was publicly released in the spring of
2009. The current version has evolved from our research experiences and those of the scientists using the suite over the last
year. The BEDTools suite enables one to answer common questions of genomic data in a fast and reliable manner. The fact that
almost all the utilities accept input from “stdin” allows one to “stream / pipe” several commands together to facilitate more
complicated analyses. Also, the tools allow fine control over how output is reported. The initial version of BEDTools
supported solely 6\-column \fI\%BED\fP files. \fIHowever, we have subsequently added support for sequence alignments in\fP \fI\%BAM\fP
\fIformat, as well as for features in\fP \fI\%GFF\fP , \fI“blocked” BED format, and\fP
\fI\%VCF\fP \fIformat\fP.
The tools are quite fast and typically finish in a matter of a few seconds, even for large datasets. This manual seeks to describe the behavior and
available functionality for each BEDTool. Usage examples are scattered throughout the text, and formal examples are
provided in the last two sections, we hope that this document will give you a sense of the flexibility of
the toolkit and the types of analyses that are possible with BEDTools. If you have further questions, please join the BEDTools
discussion group, visit the Usage Examples on the Google Code site (usage, advanced usage), or take a look at the nascent
“Usage From the Wild” page.
.SS 1.2 Summary of available tools.
.sp
BEDTools support a  wide range of operations for  interrogating and manipulating genomic features. The table below summarizes
the tools available in the suite.
.TS
center;
|l|l|.
_
T{
Utility
T}	T{
Description
T}
_
T{
\fBintersectBed\fP
T}	T{
Returns overlaps between two BED/GFF/VCF files.
T}
_
T{
\fBpairToBed\fP
T}	T{
Returns overlaps between a paired\-end BED file and a regular BED/VCF/GFF file.
T}
_
T{
\fBbamToBed\fP
T}	T{
Converts BAM alignments to BED6, BED12, or BEDPE format.
T}
_
T{
\fBbedToBam\fP
T}	T{
Converts BED/GFF/VCF features to BAM format.
T}
_
T{
\fBbed12ToBed6\fP
T}	T{
Converts "blocked" BED12 features to discrete BED6 features.
T}
_
T{
\fBbedToIgv\fP
T}	T{
Creates IGV batch scripts for taking multiple snapshots from BED/GFF/VCF features.
T}
_
T{
\fBcoverageBed\fP
T}	T{
Summarizes the depth and breadth of coverage of features in one BED versus features (e.g, windows, exons, etc.) defined in another BED/GFF/VCF file.
T}
_
T{
\fBmultiBamCov\fP
T}	T{
Counts sequence coverage for multiple position\-sorted bams at specific loci defined in a BED/GFF/VCF file
T}
_
T{
\fBtagBam\fP
T}	T{
Annotates a BAM file with custom tag fields based on overlaps with BED/GFF/VCF files
T}
_
T{
\fBnuclBed\fP
T}	T{
Profiles the nucleotide content of intervals in a fasta file
T}
_
T{
\fBgenomeCoverageBed\fP
T}	T{
Creates either a histogram, BEDGRAPH, or a "per base" report of genome coverage.
T}
_
T{
\fBunionBedGraphs\fP
T}	T{
Combines multiple BedGraph? files into a single file, allowing coverage/other comparisons between them.
T}
_
T{
\fBannotateBed\fP
T}	T{
Annotates one BED/VCF/GFF file with overlaps from many others.
T}
_
T{
\fBgroupBy\fP
T}	T{
Deprecated. Now in the filo package.
T}
_
T{
\fBoverlap\fP
T}	T{
Returns the number of bases pairs of overlap b/w two features on the same line.
T}
_
T{
\fBpairToPair\fP
T}	T{
Returns overlaps between two paired\-end BED files.
T}
_
T{
\fBclosestBed\fP
T}	T{
Returns the closest feature to each entry in a BED/GFF/VCF file.
T}
_
T{
\fBsubtractBed\fP
T}	T{
Removes the portion of an interval that is overlapped by another feature.
T}
_
T{
\fBwindowBed\fP
T}	T{
Returns overlaps between two BED/VCF/GFF files based on a user\-defined window.
T}
_
T{
\fBmergeBed\fP
T}	T{
Merges overlapping features into a single feature.
T}
_
T{
\fBcomplementBed\fP
T}	T{
Returns all intervals not spanned by the features in a BED/GFF/VCF file.
T}
_
T{
\fBfastaFromBed\fP
T}	T{
Creates FASTA sequences based on intervals in a BED/GFF/VCF file.
T}
_
T{
\fBmaskFastaFromBed\fP
T}	T{
Masks a FASTA file based on BED coordinates.
T}
_
T{
\fBshuffleBed\fP
T}	T{
Randomly permutes the locations of a BED file among a genome.
T}
_
T{
\fBslopBed\fP
T}	T{
Adjusts each BED entry by a requested number of base pairs.
T}
_
T{
\fBflankBed\fP
T}	T{
Creates flanking intervals for each feature in a BED/GFF/VCF file.
T}
_
T{
\fBsortBed\fP
T}	T{
Sorts a BED file by chrom, then start position. Other ways as well.
T}
_
T{
\fBlinksBed\fP
T}	T{
Creates an HTML file of links to the UCSC or a custom browser.
T}
_
.TE
.SS 1.3 Fundamental concepts.
.SS 1.3.1 What are genome features and how are they represented?
.sp
Throughout this manual, we will discuss how to use BEDTools to manipulate, compare and ask questions of genome “features”. Genome features can be functional elements (e.g., genes), genetic polymorphisms (e.g.
SNPs, INDELs, or structural variants), or other annotations that have been discovered or curated by genome sequencing groups or genome browser groups. In addition, genome features can be custom annotations that
an individual lab or researcher defines (e.g., my novel gene or variant).
.sp
The basic characteristics of a genome feature are the chromosome or scaffold on which the feature “resides”, the base pair on which the
feature starts (i.e. the “start”), the base pair on which feature ends (i.e. the “end”), the strand on which the feature exists (i.e. “+” or “\-“), and the name of the feature if one is applicable.
.sp
The two most widely used formats for representing genome features are the BED (Browser Extensible Data) and GFF (General Feature Format) formats. BEDTools was originally written to work exclusively with genome features
described using the BED format, but it has been recently extended to seamlessly work with BED, GFF and VCF files.
.sp
Existing annotations for the genomes of many species can be easily downloaded in BED and GFF
format from the UCSC Genome Browser’s “Table Browser” (\fI\%http://genome.ucsc.edu/cgi-bin/hgTables?command=start\fP) or from the “Bulk Downloads” page (\fI\%http://hgdownload.cse.ucsc.edu/downloads.html\fP). In addition, the
Ensemble Genome Browser contains annotations in GFF/GTF format for many species (\fI\%http://www.ensembl.org/info/data/ftp/index.html\fP)
.SS 1.3.2 Overlapping / intersecting features.
.sp
Two genome features (henceforth referred to as “features”) are said to overlap or intersect if they share at least one base in common.
In the figure below, Feature A intersects/overlaps Feature B, but it does not intersect/overlap Feature C.
.sp
\fBTODO: place figure here\fP
.SS 1.3.3 Comparing features in file “A” and file “B”.
.sp
The previous section briefly introduced a fundamental naming convention used in BEDTools. Specifically, all BEDTools that compare features contained in two distinct files refer to one file as feature set “A” and the other file as feature set “B”. This is mainly in the interest of brevity, but it also has its roots in set theory.
As an example, if one wanted to look for SNPs (file A) that overlap with exons (file B), one would use intersectBed in the following manner:
.sp
.nf
.ft C
intersectBed –a snps.bed –b exons.bed
.ft P
.fi
.sp
There are two exceptions to this rule: 1) When the “A” file is in BAM format, the “\-abam” option must bed used. For example:
.sp
.nf
.ft C
intersectBed –abam alignedReads.bam –b exons.bed
.ft P
.fi
.sp
And 2) For tools where only one input feature file is needed, the “\-i” option is used. For example:
.sp
.nf
.ft C
mergeBed –i repeats.bed
.ft P
.fi
.SS 1.3.4 BED starts are zero\-based and BED ends are one\-based.
.sp
BEDTools users are sometimes confused by the way the start and end of BED features are represented. Specifically, BEDTools uses the UCSC Genome Browser’s internal database convention of making the start position 0\-based and the end position 1\-based: (\fI\%http://genome.ucsc.edu/FAQ/FAQtracks#tracks1\fP)
In other words, BEDTools interprets the “start” column as being 1 basepair higher than what is represented in the file. For example, the following BED feature represents a single base on chromosome 1; namely, the 1st base:
.sp
.nf
.ft C
chr1   0        1    first_base
.ft P
.fi
.sp
Why, you might ask? The advantage of storing features this way is that when computing the length of a feature, one must simply subtract the start from the end. Were the start position 1\-based,
the calculation would be (slightly) more complex (i.e. (end\-start)+1). Thus, storing BED features this way reduces the computational burden.
.SS 1.3.5 GFF starts and ends are one\-based.
.sp
In contrast, the GFF format uses 1\-based coordinates for both the start and the end positions. BEDTools is aware of this and adjusts the positions accordingly.
In other words, you don’t need to subtract 1 from the start positions of your GFF features for them to work correctly with BEDTools.
.SS 1.3.6 VCF coordinates are one\-based.
.sp
The VCF format uses 1\-based coordinates. As in GFF, BEDTools is aware of this and adjusts the positions accordingly.
In other words, you don’t need to subtract 1 from the start positions of your VCF features for them to work correctly with BEDTools.
.SS 1.3.7 File B is loaded into memory (most of the time).
.sp
Whenever a BEDTool compares two files of features, the “B” file is loaded into memory. By contrast, the “A” file is processed line by line and compared with the features from B.
Therefore to minimize memory usage, one should set the smaller of the two files as the B file. One salient example is the comparison of aligned sequence reads from a
current DNA sequencer to gene annotations.      In this case, the aligned sequence file (in BED format) may have tens of millions of features (the sequence alignments),
while the gene annotation file will have tens of thousands of features. In this case, it is wise to sets the reads as file A and the genes as file B.
.SS 1.3.8 Feature files \fImust\fP be tab\-delimited.
.sp
This is rather self\-explanatory. While it is possible to allow BED files to be space\-delimited, we have decided to require tab delimiters for three reasons:
.INDENT 0.0
.IP 1. 3
By requiring one delimiter type, the processing time is minimized.
.IP 2. 3
Tab\-delimited files are more amenable to other UNIX utilities.
.IP 3. 3
GFF files can contain spaces within attribute columns. This complicates the use of space\-delimited files as spaces must therefore be treated specially depending on the context.
.UNINDENT
.SS 1.3.9 All BEDTools allow features to be “piped” via standard input.
.sp
In an effort to allow one to combine multiple BEDTools and other UNIX utilities into more complicated “pipelines”, all BEDTools allow features
to be passed to them via standard input. Only one feature file may be passed to a BEDTool via standard input.
The convention used by all BEDTools is to set either file A or file B to “stdin” or "\-". For example:
.sp
.nf
.ft C
cat snps.bed | intersectBed –a stdin –b exons.bed
cat snps.bed | intersectBed –a \- –b exons.bed
.ft P
.fi
.sp
In addition, all BEDTools that simply require one main input file (the \-i file) will assume that input is
coming from standard input if the \-i parameter is ignored. For example, the following are equivalent:
.sp
.nf
.ft C
cat snps.bed | sortBed –i stdin
cat snps.bed | sortBed
.ft P
.fi
.SS 1.3.10 Most BEDTools write their results to standard output.
.sp
To allow one to combine multiple BEDTools and other UNIX utilities into more complicated “pipelines”,
most BEDTools report their output to standard output, rather than to a named file. If one wants to write the output to a named file, one can use the UNIX “file redirection” symbol “>” to do so.
Writing to standard output (the default):
.sp
.nf
.ft C
intersectBed –a snps.bed –b exons.bed
chr1 100100 100101 rs233454
chr1 200100 200101 rs446788
chr1 300100 300101 rs645678
.ft P
.fi
.sp
Writing to a file:
.sp
.nf
.ft C
intersectBed –a snps.bed –b exons.bed > snps.in.exons.bed

cat snps.in.exons.bed
chr1 100100 100101 rs233454
chr1 200100 200101 rs446788
chr1 300100 300101 rs645678
.ft P
.fi
.SS 1.3.11 What is a “genome” file?
.sp
Some of the BEDTools (e.g., genomeCoverageBed, complementBed, slopBed) need to know the size of
the chromosomes for the organism for which your BED files are based. When using the UCSC Genome
Browser, Ensemble, or Galaxy, you typically indicate which species / genome build you are working.
The way you do this for BEDTools is to create a “genome” file, which simply lists the names of the
chromosomes (or scaffolds, etc.) and their size (in basepairs).
Genome files must be tab\-delimited and are structured as follows (this is an example for C. elegans):
.sp
.nf
.ft C
chrI 15072421
chrII 15279323
\&...
chrX 17718854
chrM 13794
.ft P
.fi
.sp
BEDTools includes predefined genome files for human and mouse in the /genomes directory included
in the BEDTools distribution. Additionally, the “chromInfo” files/tables available from the UCSC
Genome Browser website are acceptable. For example, one can download the hg19 chromInfo file here:
\fI\%http://hgdownload.cse.ucsc.edu/goldenPath/hg19/database/chromInfo.txt.gz\fP
.SS 1.3.12 Paired\-end BED files (BEDPE files).
.sp
We have defined a new file format (BEDPE) to concisely describe disjoint genome features, such as
structural variations or paired\-end sequence alignments. We chose to define a new format because the
existing BED block format (i.e. BED12) does not allow inter\-chromosomal feature definitions. Moreover,
the BED12 format feels rather bloated when one want to describe events with only two blocks.
.SS 1.3.13 Use “\-h” for help with any BEDTool.
.sp
Rather straightforward. If you use the “\-h” option with any BEDTool, a full menu of example usage
and available options (when applicable) will be reported.
.SS 1.3.14 BED features must not contain negative positions.
.sp
BEDTools will typically reject BED features that contain negative positions. In special cases, however,
BEDPE positions may be set to \-1 to indicate that one or more ends of a BEDPE feature is unaligned.
.SS 1.3.15 The start position must be <= to the end position.
.sp
BEDTools will reject BED features where the start position is greater than the end position.
.SS 1.3.16 Headers are allowed in GFF and BED files
.sp
BEDTools will ignore headers at the beginning of BED and GFF files. Valid header lines begin with a
“#” symbol, the work “track”, or the word “browser”. For example, the following examples are valid
headers for BED or GFF files:
.sp
.nf
.ft C
track name=aligned_read description="Illumina aligned reads”
chr5 100000 500000 read1 50 +
chr5 2380000 2386000 read2 60 \-

#This is a fascinating dataset
chr5 100000 500000 read1 50 +
chr5 2380000 2386000 read2 60 \-

browser position chr22:1\-20000
chr5 100000 500000 read1 50 +
chr5 2380000 2386000 read2 60 \-
.ft P
.fi
.SS 1.3.17 GZIP support: BED, GFF, VCF, and BEDPE file can be “gzipped”
.sp
BEDTools will process gzipped BED, GFF, VCF and BEDPE files in the same manner as
uncompressed files. Gzipped files are auto\-detected thanks to a helpful contribution from Gordon
Assaf.
.SS 1.3.18 Support for “split” or “spliced” BAM alignments and “blocked” BED features
.sp
As of Version 2.8.0, five BEDTools (\fBintersectBed\fP, \fBcoverageBed\fP, \fBgenomeCoverageBed\fP,
\fBbamToBed\fP, and \fBbed12ToBed6\fP) can properly handle “split”/”spliced” BAM alignments (i.e., having an
“N” CIGAR operation) and/or “blocked” BED (aka BED12) features.
.sp
\fBintersectBed\fP, \fBcoverageBed\fP, and \fBgenomeCoverageBed\fP will optionally handle “split” BAM and/or
“blocked” BED by using the \fB\-split\fP option. This will cause intersects or coverage to be computed only
for the alignment or feature blocks. In contrast, without this option, the intersects/coverage would be
computed for the entire “span” of the alignment or feature, regardless of the size of the gaps between
each alignment or feature block. For example, imagine you have a RNA\-seq read that originates from
the junction of two exons that were spliced together in a mRNA. In the genome, these two exons
happen to be 30Kb apart. Thus, when the read is aligned to the reference genome, one portion of the
read will align to the first exon, while another portion of the read will align ca. 30Kb downstream to the
other exon. The corresponding CIGAR string would be something like (assuming a 76bp read):
30M*3000N*46M. In the genome, this alignment “spans” 3076 bp, yet the nucleotides in the sequencing
read only align “cover” 76bp. Without the \fB\-split\fP option, coverage or overlaps would be reported for the
entire 3076bp span of the alignment. However, with the \fB\-split\fP option, coverage or overlaps will only
be reported for the portions of the read that overlap the exons (i.e. 30bp on one exon, and
46bp on the other).
.sp
Using the \-split option with bamToBed causes “spliced/split” alignments to be reported in BED12
format. Using the \-split option with bed12ToBed6 causes “blocked” BED12 features to be reported in
BED6 format.
.SS 1.3.19 Writing uncompressed BAM output.
.sp
When working with a large BAM file using a complex set of tools in a pipe/stream, it is advantageous
to pass uncompressed BAM output to each downstream program. This minimizes the amount of time
spent compressing and decompressing output from one program to the next. All BEDTools that create
BAM output (e.g. \fBintersectBed\fP, \fBwindowBed\fP) will now optionally create uncompressed BAM output
using the \fB\-ubam\fP option.
.SS 1.4 Implementation and algorithmic notes.
.sp
BEDTools was implemented in C++ and makes extensive use of data structures and fundamental
algorithms from the Standard Template Library (STL). Many of the core algorithms are based upon the
genome binning algorithm described in the original UCSC Genome Browser paper (Kent et al, 2002).
The tools have been designed to inherit core data structures from central source files, thus allowing
rapid tool development and deployment of improvements and corrections. Support for BAM files is
made possible through Derek Barnett’s elegant C++ API called BamTools.
.SS 1.5 License and availability.
.sp
BEDTools is freely available under a GNU Public License (Version 2) at:
\fI\%http://bedtools.googlecode.com\fP
.SS 1.6 Mailing list.
.sp
A discussion group for reporting bugs, asking questions of the developer and of the user community, as
well as for requesting new features is available at:
\fI\%http://groups.google.com/group/bedtools-discuss\fP
.SS 1.7 Contributors.
.sp
As open\-source software, BEDTools greatly benefits from contributions made by other developers and
users of the tools. We encourage and welcome suggestions, contributions and complaints. This is how
software matures, improves and stays on top of the needs of its user community. The Google Code
(GC) site maintains a list of individuals who have contributed either source code or useful ideas for
improving the tools. In the near future, we hope to maintain a source repository on the GC site in
order to facilitate further contributions. We are currently unable to do so because we use Git for
version control, which is not yet supported by GC.
.SH INSTALLATION
.sp
BEDTools is intended to run in a "command line" environment on UNIX, LINUX and Apple OS X
operating systems. Installing BEDTools involves downloading the latest source code archive followed by
compiling the source code into binaries on your local system. The following commands will install
BEDTools in a local directory on a NIX or OS X machine. Note that the \fB"<version>"\fP refers to the
latest posted version number on \fI\%http://bedtools.googlecode.com/\fP.
.sp
Note: \fIThe BEDTools "makefiles" use the GCC compiler. One should edit the Makefiles accordingly if
one wants to use a different compiler.\fP:
.sp
.nf
.ft C
curl http://bedtools.googlecode.com/files/BEDTools.<version>.tar.gz > BEDTools.tar.gz
tar \-zxvf BEDTools.tar.gz
cd BEDTools\-<version>
make clean
make all
ls bin
.ft P
.fi
.sp
At this point, one should copy the binaries in BEDTools/bin/ to either usr/local/bin/ or some
other repository for commonly used UNIX tools in your environment. You will typically require
administrator (e.g. "root" or "sudo") privileges to copy to usr/local/bin/. If in doubt, contact you
system administrator for help.
.SH QUICK START
.SS Install BEDTools
.sp
.nf
.ft C
curl http://bedtools.googlecode.com/files/BEDTools.<version>.tar.gz > BEDTools.tar.gz
tar \-zxvf BEDTools.tar.gz
cd BEDTools
make clean
make all
sudo cp bin/* /usr/local/bin/
.ft P
.fi
.SS Use BEDTools
.sp
Below are examples of typical BEDTools usage. \fBAdditional usage examples are described in
section 6 of this manual.\fP Using the "\-h" option with any BEDTools will report a list of all command
line options.
.sp
A. Report the base\-pair overlap between the features in two BED files.
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed
.ft P
.fi
.sp
B. Report those entries in A that overlap NO entries in B. Like "grep \-v"
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed ?Cv
.ft P
.fi
.sp
C. Read BED A from stdin. Useful for stringing together commands. For example, find genes that overlap LINEs
but not SINEs.
.sp
.nf
.ft C
intersectBed \-a genes.bed \-b LINES.bed | intersectBed \-a stdin \-b SINEs.bed ?Cv
.ft P
.fi
.sp
D. Find the closest ALU to each gene.
.sp
.nf
.ft C
closestBed \-a genes.bed \-b ALUs.bed
.ft P
.fi
.sp
E. Merge overlapping repetitive elements into a single entry, returning the number of entries merged.
.sp
.nf
.ft C
mergeBed \-i repeatMasker.bed \-n
.ft P
.fi
.sp
F. Merge nearby repetitive elements into a single entry, so long as they are within 1000 bp of one another.
.sp
.nf
.ft C
mergeBed \-i repeatMasker.bed \-d 1000
.ft P
.fi
.SH GENERAL USAGE
.SS 4.1 Supported file formats
.SS 4.1.1 BED format
.sp
As described on the UCSC Genome Browser website (see link below), the BED format is a concise and
flexible way to represent genomic features and annotations. The BED format description supports up to
12 columns, but only the first 3 are required for the UCSC browser, the Galaxy browser and for
BEDTools. BEDTools allows one to use the "BED12" format (that is, all 12 fields listed below).
However, only intersectBed, coverageBed, genomeCoverageBed, and bamToBed will obey the BED12
"blocks" when computing overlaps, etc., via the \fB"\-split"\fP option. For all other tools, the last six columns
are not used for any comparisons by the BEDTools. Instead, they will use the entire span (start to end)
of the BED12 entry to perform any relevant feature comparisons. The last six columns will be reported
in the output of all comparisons.
.sp
The file description below is modified from: \fI\%http://genome.ucsc.edu/FAQ/FAQformat#format1\fP.
.INDENT 0.0
.IP 1. 3
\fBchrom\fP \- The name of the chromosome on which the genome feature exists.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, "chr1", "III", "myChrom", "contig1112.23".
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 2. 3
\fBstart\fP \- The zero\-based starting position of the feature in the chromosome.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThe first base in a chromosome is numbered 0\fP.
.IP \(bu 2
\fIThe start position in each BED feature is therefore interpreted to be 1 greater than the start position listed in the feature. For example, start=9, end=20 is interpreted to span bases 10 through 20,inclusive\fP.
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 3. 3
\fBend\fP \- The one\-based ending position of the feature in the chromosome.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThe end position in each BED feature is one\-based. See example above\fP.
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 4. 3
\fBname\fP \- Defines the name of the BED feature.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, "LINE", "Exon3", "HWIEAS_0001:3:1:0:266#0/1", or "my_Feature".
.IP \(bu 2
\fIThis column is optional\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 5. 3
\fBscore\fP \- The UCSC definition requires that a BED score range from 0 to 1000, inclusive. However, BEDTools allows any string to be stored in this field in order to allow greater flexibility in annotation features. For example, strings allow scientific notation for p\-values, mean enrichment values, etc. It should be noted that this flexibility could prevent such annotations from being correctly displayed on the UCSC browser.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, 7.31E\-05 (p\-value), 0.33456 (mean enrichment value), "up", "down", etc.
.IP \(bu 2
\fIThis column is optional\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 6. 3
\fBstrand\fP \- Defines the strand \- either \(aq+\(aq or \(aq\-\(aq.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is optional\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 7. 3
\fBthickStart\fP \- The starting position at which the feature is drawn thickly.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAllowed yet ignored by BEDTools\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 8. 3
\fBthickEnd\fP \- The ending position at which the feature is drawn thickly.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAllowed yet ignored by BEDTools\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 9. 3
\fBitemRgb\fP \- An RGB value of the form R,G,B (e.g. 255,0,0).
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAllowed yet ignored by BEDTools\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 10. 3
\fBblockCount\fP \- The number of blocks (exons) in the BED line.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAllowed yet ignored by BEDTools\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 11. 4
\fBblockSizes\fP \- A comma\-separated list of the block sizes.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAllowed yet ignored by BEDTools\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 12. 4
\fBblockStarts\fP \- A comma\-separated list of block starts.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAllowed yet ignored by BEDTools\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.sp
BEDTools requires that all BED input files (and input received from stdin) are \fBtab\-delimited\fP. The following types of BED files are supported by BEDTools:
.INDENT 0.0
.IP 1. 3
.nf
\fBBED3\fP: A BED file where each feature is described by \fBchrom\fP, \fBstart\fP, and \fBend\fP.
For example: chr1          11873   14409
.fi
.sp
.IP 2. 3
.nf
\fBBED4\fP: A BED file where each feature is described by \fBchrom\fP, \fBstart\fP, \fBend\fP, and \fBname\fP.
For example: chr1  11873  14409  uc001aaa.3
.fi
.sp
.IP 3. 3
.nf
\fBBED5\fP: A BED file where each feature is described by \fBchrom\fP, \fBstart\fP, \fBend\fP, \fBname\fP, and \fBscore\fP.
For example: chr1 11873 14409 uc001aaa.3 0
.fi
.sp
.IP 4. 3
.nf
\fBBED6\fP: A BED file where each feature is described by \fBchrom\fP, \fBstart\fP, \fBend\fP, \fBname\fP, \fBscore\fP, and \fBstrand\fP.
For example: chr1 11873 14409 uc001aaa.3 0 +
.fi
.sp
.IP 5. 3
.nf
\fBBED12\fP: A BED file where each feature is described by all twelve columns listed above.
For example: chr1 11873 14409 uc001aaa.3 0 + 11873
11873 0 3 354,109,1189, 0,739,1347,
.fi
.sp
.UNINDENT
.SS 4.1.2 BEDPE format
.sp
We have defined a new file format (BEDPE) in order to concisely describe disjoint genome features,
such as structural variations or paired\-end sequence alignments. We chose to define a new format
because the existing "blocked" BED format (a.k.a. BED12) does not allow inter\-chromosomal feature
definitions. In addition, BED12 only has one strand field, which is insufficient for paired\-end sequence
alignments, especially when studying structural variation.
.sp
The BEDPE format is described below. The description is modified from: \fI\%http://genome.ucsc.edu/FAQ/FAQformat#format1\fP.
.INDENT 0.0
.IP 1. 3
\fBchrom1\fP \- The name of the chromosome on which the \fBfirst\fP end of the feature exists.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, "chr1", "III", "myChrom", "contig1112.23".
.IP \(bu 2
\fIThis column is required\fP.
.IP \(bu 2
\fIUse "." for unknown\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 2. 3
\fBstart1\fP \- The zero\-based starting position of the \fBfirst\fP end of the feature on \fBchrom1\fP.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThe first base in a chromosome is numbered 0\fP.
.IP \(bu 2
\fIAs with BED format, the start position in each BEDPE feature is therefore interpreted to be 1 greater than the start position listed in the feature. This column is required\fP.
.IP \(bu 2
\fIUse \-1 for unknown\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 3. 3
\fBend1\fP \- The one\-based ending position of the first end of the feature on \fBchrom1\fP.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThe end position in each BEDPE feature is one\-based\fP.
.IP \(bu 2
\fIThis column is required\fP.
.IP \(bu 2
\fIUse \-1 for unknown\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 4. 3
\fBchrom2\fP \- The name of the chromosome on which the \fBsecond\fP end of the feature exists.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, "chr1", "III", "myChrom", "contig1112.23".
.IP \(bu 2
\fIThis column is required\fP.
.IP \(bu 2
\fIUse "." for unknown\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 5. 3
\fBstart2\fP \- The zero\-based starting position of the \fBsecond\fP end of the feature on \fBchrom2\fP.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThe first base in a chromosome is numbered 0\fP.
.IP \(bu 2
\fIAs with BED format, the start position in each BEDPE feature is therefore interpreted to be 1 greater than the start position listed in the feature. This column is required\fP.
.IP \(bu 2
\fIUse \-1 for unknown\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 6. 3
\fBend2\fP \- The one\-based ending position of the \fBsecond\fP end of the feature on \fBchrom2\fP.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThe end position in each BEDPE feature is one\-based\fP.
.IP \(bu 2
\fIThis column is required\fP.
.IP \(bu 2
\fIUse \-1 for unknown\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 7. 3
\fBname\fP \- Defines the name of the BEDPE feature.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, "LINE", "Exon3", "HWIEAS_0001:3:1:0:266#0/1", or "my_Feature".
.IP \(bu 2
\fIThis column is optional\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 8. 3
\fBscore\fP \- The UCSC definition requires that a BED score range from 0 to 1000, inclusive. \fIHowever, BEDTools allows any string to be stored in this field in order to allow greater flexibility in annotation features\fP. For example, strings allow scientific notation for p\-values, mean enrichment values, etc. It should be noted that this flexibility could prevent such annotations from being correctly displayed on the UCSC browser.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, 7.31E\-05 (p\-value), 0.33456 (mean enrichment value), "up", "down", etc.
.IP \(bu 2
\fIThis column is optional\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 9. 3
\fBstrand1\fP \- Defines the strand for the first end of the feature. Either \(aq+\(aq or \(aq\-\(aq.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is optional\fP.
.IP \(bu 2
\fIUse "." for unknown\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 10. 3
\fBstrand2\fP \- Defines the strand for the second end of the feature. Either \(aq+\(aq or \(aq\-\(aq.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is optional\fP.
.IP \(bu 2
\fIUse "." for unknown\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 11. 4
\fBAny number of additional, user\-defined fields\fP \- BEDTools allows one to add as many additional fields to the normal, 10\-column BEDPE format as necessary. These columns are merely "passed through" \fBpairToBed\fP and \fBpairToPair\fP and are not part of any analysis. One would use these additional columns to add extra information (e.g., edit distance for each end of an alignment, or "deletion", "inversion", etc.) to each BEDPE feature.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThese additional columns are optional\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.sp
Entries from an typical BEDPE file:
.sp
.nf
.ft C
chr1  100   200   chr5  5000  5100  bedpe_example1  30   +  \-
chr9  1000  5000  chr9  3000  3800  bedpe_example2  100  +  \-
.ft P
.fi
.sp
Entries from a BEDPE file with two custom fields added to each record:
.sp
.nf
.ft C
chr1  10    20    chr5  50    60    a1     30       +    \-  0  1
chr9  30    40    chr9  80    90    a2     100      +    \-  2  1
.ft P
.fi
.SS 4.1.3 GFF format
.sp
The GFF format is described on the Sanger Institute\(aqs website (\fI\%http://www.sanger.ac.uk/resources/software/gff/spec.html\fP). The GFF description below is modified from the definition at this URL. All nine columns in the GFF format description are required by BEDTools.
.INDENT 0.0
.IP 1. 3
\fBseqname\fP \- The name of the sequence (e.g. chromosome) on which the feature exists.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, "chr1", "III", "myChrom", "contig1112.23".
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 2. 3
\fBsource\fP \- The source of this feature. This field will normally be used to indicate the program making the prediction, or if it comes from public database annotation, or is experimentally verified, etc.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 3. 3
\fBfeature\fP \- The feature type name. Equivalent to BED\(aqs \fBname\fP field.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIAny string can be used\fP. For example, "exon", etc.
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 4. 3
\fBstart\fP \- The one\-based starting position of feature on \fBseqname\fP.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is required\fP.
.IP \(bu 2
\fIBEDTools accounts for the fact the GFF uses a one\-based position and BED uses a zero\-based start position\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 5. 3
\fBend\fP \- The one\-based ending position of feature on \fBseqname\fP.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 6. 3
\fBscore\fP \- A score assigned to the GFF feature. Like BED format, BEDTools allows any string to be stored in this field in order to allow greater flexibility in annotation features. We note that this differs from the GFF definition in the interest of flexibility.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 7. 3
\fBstrand\fP \- Defines the strand. Use \(aq+\(aq, \(aq\-\(aq or \(aq.\(aq
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 8. 3
\fBframe\fP \-  The frame of the coding sequence. Use \(aq0\(aq, \(aq1\(aq, \(aq2\(aq, or \(aq.\(aq.
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.INDENT 0.0
.IP 9. 3
\fBattribute\fP \- Taken from \fI\%http://www.sanger.ac.uk/resources/software/gff/spec.html\fP: From version 2 onwards, the attribute field must have an tag value structure following the syntax used within objects in a .ace file, flattened onto one line by semicolon separators. Tags must be standard identifiers ([A\-Za\-z][
.nf
AZa\-z0\-9_
.fi
]*). Free text values must be quoted with double quotes. \fINote: all non\-printing characters in such free text value strings (e.g. newlines, tabs, control characters, etc) must be explicitly represented by their C (UNIX) style backslash\-escaped representation (e.g. newlines as \(aqn\(aq, tabs as \(aqt\(aq)\fP. As in ACEDB, multiple values can follow a specific tag. The aim is to establish consistent use of particular tags, corresponding to an underlying implied ACEDB model if you want to think that way (but acedb is not required).
.UNINDENT
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
\fIThis column is required\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.sp
An entry from an example GFF file :
.sp
.nf
.ft C
seq1 BLASTX similarity 101 235 87.1 + 0 Target "HBA_HUMAN" 11 55 ;
E_value 0.0003 dJ102G20 GD_mRNA coding_exon 7105 7201 . \- 2 Sequence
"dJ102G20.C1.1"
.ft P
.fi
.SS 4.1.3 GFF format
.sp
Some of the BEDTools (e.g., genomeCoverageBed, complementBed, slopBed) need to know the size of
the chromosomes for the organism for which your BED files are based. When using the UCSC Genome
Browser, Ensemble, or Galaxy, you typically indicate which which species/genome build you are
working. The way you do this for BEDTools is to create a "genome" file, which simply lists the names of
the chromosomes (or scaffolds, etc.) and their size (in basepairs).
.sp
Genome files must be \fBtab\-delimited\fP and are structured as follows (this is an example for \fIC. elegans\fP):
.sp
.nf
.ft C
chrI  15072421
chrII 15279323
\&...
chrX  17718854
chrM  13794
.ft P
.fi
.sp
BEDTools includes pre\-defined genome files for human and mouse in the \fB/genomes\fP directory included
in the BEDTools distribution.
.SS 4.1.5 SAM/BAM format
.sp
The SAM / BAM format is a powerful and widely\-used format for storing sequence alignment data (see
\fI\%http://samtools.sourceforge.net/\fP for more details). It has quickly become the standard format to which
most DNA sequence alignment programs write their output. Currently, the following BEDTools
support inout in BAM format: \fIintersectBed, windowBed, coverageBed, genomeCoverageBed,
pairToBed, bamToBed\fP. Support for the BAM format in BEDTools allows one to (to name a few):
compare sequence alignments to annotations, refine alignment datasets, screen for potential mutations
and compute aligned sequence coverage.
.sp
The details of how these tools work with BAM files are addressed in \fBSection 5\fP of this manual.
.SS 4.1.6 VCF format
.sp
The Variant Call Format (VCF) was conceived as part of the 1000 Genomes Project as a standardized
means to report genetic variation calls from SNP, INDEL and structural variant detection programs
(see \fI\%http://www.1000genomes.org/wiki/doku.php?id=1000_genomes:analysis:vcf4.0\fP for details).
BEDTools now supports the latest version of this format (i.e, Version 4.0). As a result, BEDTools can
be used to compare genetic variation calls with other genomic features.
.SH THE BEDTOOLS SUITE
.sp
This section covers the functionality and default / optional usage for each of the available BEDTools.
Example "figures" are provided in some cases in an effort to convey the purpose of the tool. The
behavior of each available parameter is discussed for each tool in abstract terms. More concrete usage
examples are provided in \fBSection 6\fP.
.SS Table of contents
.SS 5.1 intersectBed
.sp
By far, the most common question asked of two sets of genomic features is whether or not any of the
features in the two sets "overlap" with one another. This is known as feature intersection. \fBintersectBed\fP
allows one to screen for overlaps between two sets of genomic features. Moreover, it allows one to have
fine control as to how the intersections are reported. \fBintersectBed\fP works with both BED/GFF/VCF
and BAM files as input.
.SS 5.1.1 Usage and option summary
.sp
\fBUsage\fP:
.sp
.nf
.ft C
intersectBed [OPTIONS] [\-a <BED/GFF/VCF> || \-abam <BAM>] \-b <BED/GFF/VCF>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-a\fP
T}	T{
BED/GFF/VCF file A. Each feature in A is compared to B in search of overlaps. Use "stdin" if passing A with a UNIX pipe.
T}
_
T{
\fB\-b\fP
T}	T{
BED/GFF/VCF file B. Use "stdin" if passing B with a UNIX pipe.
T}
_
T{
\fB\-abam\fP
T}	T{
BAM file A. Each BAM alignment in A is compared to B in search of overlaps. Use "stdin" if passing A with a UNIX pipe: For example: samtools view \-b <BAM> | intersectBed \-abam stdin \-b genes.bed
T}
_
T{
\fB\-ubam\fP
T}	T{
Write uncompressed BAM output. The default is write compressed BAM output.
T}
_
T{
\fB\-bed\fP
T}	T{
When using BAM input (\-abam), write output as BED. The default is to write output in BAM when using \-abam. For example:   intersectBed \-abam reads.bam \-b genes.bed \-bed
T}
_
T{
\fB\-wa\fP
T}	T{
Write the original entry in A for each overlap.
T}
_
T{
\fB\-wb\fP
T}	T{
Write the original entry in B for each overlap. Useful for knowing what A overlaps. Restricted by \-f and \-r.
T}
_
T{
\fB\-wo\fP
T}	T{
Write the original A and B entries plus the number of base pairs of overlap between the two features. Only A features with overlap are reported. Restricted by \-f and \-r.
T}
_
T{
\fB\-wao\fP
T}	T{
Write the original A and B entries plus the number of base pairs of overlap between the two features. However, A features w/o overlap are also reported with a NULL B feature and overlap = 0. Restricted by \-f and \-r.
T}
_
T{
\fB\-u\fP
T}	T{
Write original A entry once if any overlaps found in B. In other words, just report the fact at least one overlap was found in B. Restricted by \-f and \-r.
T}
_
T{
\fB\-c\fP
T}	T{
For each entry in A, report the number of hits in B while restricting to \-f. Reports 0 for A entries that have no overlap with B. Restricted by \-f and \-r.
T}
_
T{
\fB\-v\fP
T}	T{
Only report those entries in A that have no overlap in B. Restricted by \-f and \-r.
T}
_
T{
\fB\-f\fP
T}	T{
Minimum overlap required as a fraction of A. Default is 1E\-9 (i.e. 1bp).
T}
_
T{
\fB\-r\fP
T}	T{
Require that the fraction of overlap be reciprocal for A and B. In other words, if \-f is 0.90 and \-r is used, this requires that B overlap at least 90% of A and that A also overlaps at least 90% of B.
T}
_
T{
\fB\-s\fP
T}	T{
Force "strandedness". That is, only report hits in B that overlap A on the same strand. By default, overlaps are reported without respect to strand.
T}
_
T{
\fB\-split\fP
T}	T{
Treat "split" BAM (i.e., having an "N" CIGAR operation) or BED12 entries as distinct BED intervals.
T}
_
.TE
.SS 5.1.2 Default behavior
.sp
By default, if an overlap is found, \fBintersectBed\fP reports the shared interval between the two
overlapping features.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BED/BAM A      *******************            *************

BED File B                ^^^^^^^^

Result                    ========
.ft P
.fi
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1 100 200
chr1 1000 2000

cat B.bed
chr1 150 250

intersectBed \-a A.bed \-b B.bed
chr1 150 200
.ft P
.fi
.SS 5.1.3 (\-wa)Reporting the original A feature
.sp
Instead, one can force \fBintersectBed\fP to report the \fIoriginal\fP \fB"A"\fP feature when an overlap is found. As
shown below, the entire "A" feature is reported, not just the portion that overlaps with the "B" feature.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BED/BAM A      *******************            *************

BED File B                ^^^^^^^^

Result         ===================
.ft P
.fi
.sp
For example (compare with example from default behavior):
.sp
.nf
.ft C
cat A.bed
chr1 100 200
chr1 1000 2000

cat B.bed
chr1 150 250

intersectBed \-a A.bed \-b B.bed \-wa
chr1 100 200
.ft P
.fi
.SS 5.1.4 (\-wb)Reporting the original B feature
.sp
Similarly, one can force \fBintersectBed\fP to report the \fIoriginal\fP \fB"B"\fP feature when an overlap is found. If
just \-wb is used, the overlapping portion of A will be reported followed by the \fIoriginal\fP \fB"B"\fP. If both \-wa
and \-wb are used, the \fIoriginals\fP of both \fB"A"\fP and \fB"B"\fP will be reported.
.sp
For example (\-wb alone):
.sp
.nf
.ft C
cat A.bed
chr1 100 200
chr1 1000 2000

cat B.bed
chr1 150 250

intersectBed \-a A.bed \-b B.bed \-wb
chr1 150 200 chr1 150 250
.ft P
.fi
.sp
Now \-wa and \-wb:
.sp
.nf
.ft C
cat A.bed
chr1 100 200
chr1 1000 2000

cat B.bed
chr1 150 250

intersectBed \-a A.bed \-b B.bed \-wa \-wb
chr1 100 200 chr1 150 250
.ft P
.fi
.SS 5.1.5 (\-u)Reporting the presence of \fIat least one\fP overlapping feature
.sp
Frequently a feature in "A" will overlap with multiple features in "B". By default, \fBintersectBed\fP will
report each overlap as a separate output line. However, one may want to simply know that there is at
least one overlap (or none). When one uses the \-u option, "A" features that overlap with one or more
"B" features are reported once. Those that overlap with no "B" features are not reported at all.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1 100 200
chr1 1000 2000

cat B.bed
chr1 101 201
chr1 120 220

intersectBed \-a A.bed \-b B.bed \-u
chr1 100 200
.ft P
.fi
.SS 5.1.6 (\-c)Reporting the number of overlapping features
.sp
The \-c option reports a column after each "A" feature indicating the \fInumber\fP (0 or more) of overlapping
features found in "B". Therefore, \fIeach feature in A is reported once\fP.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1 100 200
chr1 1000 2000

cat B.bed
chr1 101 201
chr1 120 220

intersectBed \-a A.bed \-b B.bed \-c
chr1 100 200 2
chr1 1000 2000 0
.ft P
.fi
.SS 5.1.6 (\-c)Reporting the number of overlapping features
.sp
The \-c option reports a column after each "A" feature indicating the \fInumber\fP (0 or more) of overlapping
features found in "B". Therefore, \fIeach feature in A is reported once\fP.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1 100 200
chr1 1000 2000

cat B.bed
chr1 101 201
chr1 120 220

intersectBed \-a A.bed \-b B.bed \-c
chr1 100 200 2
chr1 1000 2000 0
.ft P
.fi
.SS 5.1.7 (\-v)Reporting the absence of any overlapping features
.sp
There will likely be cases where you\(aqd like to know which "A" features do not overlap with any of the
"B" features. Perhaps you\(aqd like to know which SNPs don\(aqt overlap with any gene annotations. The \-v
(an homage to "grep \-v") option will only report those "A" features that have no overlaps in "B".
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1 100 200
chr1 1000 2000

cat B.bed
chr1 101 201
chr1 120 220

intersectBed \-a A.bed \-b B.bed \-v
chr1 1000 2000
.ft P
.fi
.SS 5.1.8 (\-f)Requiring a minimal overlap fraction
.sp
By default, \fBintersectBed\fP will report an overlap between A and B so long as there is at least one base
pair is overlapping. Yet sometimes you may want to restrict reported overlaps between A and B to cases
where the feature in B overlaps at least X% (e.g. 50%) of the A feature. The \-f option does exactly
this.
.sp
For example (note that the second B entry is not reported):
.sp
.nf
.ft C
cat A.bed
chr1 100 200

cat B.bed
chr1 130 201
chr1 180 220

intersectBed \-a A.bed \-b B.bed \-f 0.50 \-wa \-wb
chr1 100 200 chr1 130 201
.ft P
.fi
.SS 5.1.9 (\-r, combined with \-f)Requiring reciprocal minimal overlap fraction
.sp
Similarly, you may want to require that a minimal fraction of both the A and the B features is
overlapped. For example, if feature A is 1kb and feature B is 1Mb, you might not want to report the
overlap as feature A can overlap at most 1% of feature B. If one set \-f to say, 0.02, and one also
enable the \-r (reciprocal overlap fraction required), this overlap would not be reported.
.sp
For example (note that the second B entry is not reported):
.sp
.nf
.ft C
cat A.bed
chr1 100 200

cat B.bed
chr1 130 201
chr1 130 200000

intersectBed \-a A.bed \-b B.bed \-f 0.50 \-r \-wa \-wb
chr1 100 200 chr1 130 201
.ft P
.fi
.SS 5.1.10 (\-s)Enforcing "strandedness"
.sp
By default, \fBintersectBed\fP will report overlaps between features even if the features are on opposite
strands. However, if strand information is present in both BED files and the "\-s" option is used, overlaps
will only be reported when features are on the same strand.
.sp
For example (note that the second B entry is not reported):
.sp
.nf
.ft C
cat A.bed
chr1 100 200 a1 100 +

cat B.bed
chr1 130 201 b1 100 \-
chr1 130 201 b2 100 +

intersectBed \-a A.bed \-b B.bed \-wa \-wb \-s
chr1 100 200 a1 100 + chr1 130 201 b2 100 +
.ft P
.fi
.SS 5.1.11 (\-abam)Default behavior when using BAM input
.sp
When comparing alignments in BAM format (\fB\-abam\fP) to features in BED format (\fB\-b\fP), \fBintersectBed\fP
will, \fBby default\fP, write the output in BAM format. That is, each alignment in the BAM file that meets
the user\(aqs criteria will be written (to standard output) in BAM format. This serves as a mechanism to
create subsets of BAM alignments are of biological interest, etc. Note that only the mate in the BAM
alignment is compared to the BED file. Thus, if only one end of a paired\-end sequence overlaps with a
feature in B, then that end will be written to the BAM output. By contrast, the other mate for the
pair will not be written. One should use \fBpairToBed(Section 5.2)\fP if one wants each BAM alignment
for a pair to be written to BAM output.
.sp
For example:
.sp
.nf
.ft C
intersectBed \-abam reads.unsorted.bam \-b simreps.bed | samtools view \- | head \-3

BERTHA_0001:3:1:15:1362#0 99 chr4 9236904 0 50M = 9242033 5 1 7 9
AGACGTTAACTTTACACACCTCTGCCAAGGTCCTCATCCTTGTATTGAAG W c T U ] b \e g c e g X g f c b f c c b d d g g V Y P W W _
\ec\(gadcdabdfW^a^gggfgd XT:A:R NM:i:0 SM:i:0 AM:i:0 X0:i:19 X1:i:2 XM:i:0 XO:i:0 XG:i:0 MD:Z:50
BERTHA _0001:3:1:16:994#0 83 chr6 114221672 37 25S6M1I11M7S =
114216196 \-5493 G A A A G G C C A G A G T A T A G A A T A A A C A C A A C A A T G T C C A A G G T A C A C T G T T A
gffeaaddddggggggedgcgeggdegggggffcgggggggegdfggfgf XT:A:M NM:i:3 SM:i:37 AM:i:37 XM:i:2 X O : i :
1 XG:i:1 MD:Z:6A6T3
BERTHA _0001:3:1:16:594#0 147 chr8 43835330 0 50M =
43830893 \-4487 CTTTGGGAGGGCTTTGTAGCCTATCTGGAAAAAGGAAATATCTTCCCATG U
\ee^bgeTdg_Kgcg\(gaggeggg_gggggggggddgdggVg\egWdfgfgff XT:A:R NM:i:2 SM:i:0 AM:i:0 X0:i:10 X1:i:7 X M : i :
2 XO:i:0 XG:i:0 MD:Z:1A2T45
.ft P
.fi
.SS 5.1.12 (\-bed)Output BED format when using BAM input
.sp
When comparing alignments in BAM format (\fB\-abam\fP) to features in BED format (\fB\-b\fP), \fBintersectBed\fP
will \fBoptionally\fP write the output in BED format. That is, each alignment in the BAM file is converted
to a 6 column BED feature and if overlaps are found (or not) based on the user\(aqs criteria, the BAM
alignment will be reported in BED format. The BED "name" field is comprised of the RNAME field in
the BAM alignment. If mate information is available, the mate (e.g., "/1" or "/2") field will be
appended to the name. The "score" field is the mapping quality score from the BAM alignment.
.sp
For example:
.sp
.nf
.ft C
intersectBed \-abam reads.unsorted.bam \-b simreps.bed \-bed | head \-20

chr4  9236903   9236953   BERTHA_0001:3:1:15:1362#0/1  0   +
chr6  114221671 114221721 BERTHA_0001:3:1:16:994#0/1   37  \-
chr8  43835329  43835379  BERTHA_0001:3:1:16:594#0/2   0   \-
chr4  49110668  49110718  BERTHA_0001:3:1:31:487#0/1   23  +
chr19 27732052  27732102  BERTHA_0001:3:1:32:890#0/2   46  +
chr19 27732012  27732062  BERTHA_0001:3:1:45:1135#0/1  37  +
chr10 117494252 117494302 BERTHA_0001:3:1:68:627#0/1   37  \-
chr19 27731966  27732016  BERTHA_0001:3:1:83:931#0/2   9   +
chr8  48660075  48660125  BERTHA_0001:3:1:86:608#0/2   37  \-
chr9  34986400  34986450  BERTHA_0001:3:1:113:183#0/2  37  \-
chr10 42372771  42372821  BERTHA_0001:3:1:128:1932#0/1 3   \-
chr19 27731954  27732004  BERTHA_0001:3:1:130:1402#0/2 0   +
chr10 42357337  42357387  BERTHA_0001:3:1:137:868#0/2  9   +
chr1  159720631 159720681 BERTHA_0001:3:1:147:380#0/2  37  \-
chrX  58230155  58230205  BERTHA_0001:3:1:151:656#0/2  37  \-
chr5  142612746 142612796 BERTHA_0001:3:1:152:1893#0/1 37  \-
chr9  71795659  71795709  BERTHA_0001:3:1:177:387#0/1  37  +
chr1  106240854 106240904 BERTHA_0001:3:1:194:928#0/1  37  \-
chr4  74128456  74128506  BERTHA_0001:3:1:221:724#0/1  37  \-
chr8  42606164  42606214  BERTHA_0001:3:1:244:962#0/1  37  +
.ft P
.fi
.SS 5.1.13 (\-split)Reporting overlaps with spliced alignments or blocked BED features
.sp
As described in section 1.3.19, intersectBed will, by default, screen for overlaps against the entire span
of a spliced/split BAM alignment or blocked BED12 feature. When dealing with RNA\-seq reads, for
example, one typically wants to only screen for overlaps for the portions of the reads that come from
exons (and ignore the interstitial intron sequence). The \fB\-split\fP command allows for such overlaps to be
performed.
.sp
For example, the diagram below illustrates the \fIdefault\fP behavior. The blue dots represent the "split/
spliced" portion of the alignment (i.e., CIGAR "N" operation). In this case, the two exon annotations
are reported as overlapping with the "split" BAM alignment, but in addition, a third feature that
overlaps the "split" portion of the alignment is also reported.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Exons       \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-                                       \-\-\-\-\-\-\-\-\-\-

BED/BAM  A     ************.......................................****

BED File B  ^^^^^^^^^^^^^^^                     ^^^^^^^^          ^^^^^^^^^^

Result      ===============                     ========          ==========
.ft P
.fi
.sp
In contrast, when using the \fB\-split\fP option, only the exon overlaps are reported.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Exons       \-\-\-\-\-\-\-\-\-\-\-\-\-\-\-                                       \-\-\-\-\-\-\-\-\-\-

BED/BAM  A     ************.......................................****

BED File B  ^^^^^^^^^^^^^^^                     ^^^^^^^^          ^^^^^^^^^^

Result      ===============                                       ==========
.ft P
.fi
.SS 5.2 pairToBed
.sp
\fBpairToBed\fP compares each end of a BEDPE feature or a paired\-end BAM alignment to a feature file in
search of overlaps.
.sp
\fBNOTE: pairToBed requires that the BAM file is sorted/grouped by the read name. This
allows pairToBed to extract correct alignment coordinates for each end based on their
respective CIGAR strings. It also assumes that the alignments for a given pair come in
groups of twos. There is not yet a standard method for reporting multiple alignments
using BAM. pairToBed will fail if an aligner does not report alignments in pairs.\fP
.SS 5.2.1 Usage and option summary
.sp
\fBUsage:\fP
.sp
.nf
.ft C
pairToBed [OPTIONS] [\-a <BEDPE> || \-abam <BAM>] \-b <BED/GFF/VCF>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-a\fP
T}	T{
BEDPE file A. Each feature in A is compared to B in search of overlaps. Use "stdin" if passing A with a UNIX pipe. Output will be in BEDPE format.
T}
_
T{
\fB\-b\fP
T}	T{
BED file B. Use "stdin" if passing B with a UNIX pipe.
T}
_
T{
\fB\-abam\fP
T}	T{
BAM file A. Each end of each BAM alignment in A is compared to B in search of overlaps. Use "stdin" if passing A with a UNIX pipe: For example: samtools view ?Cb <BAM> | pairToBed ?Cabam stdin ?Cb genes.bed | samtools view \-
T}
_
T{
\fB\-ubam\fP
T}	T{
Write uncompressed BAM output. The default is write compressed BAM output.
T}
_
T{
\fB\-bedpe\fP
T}	T{
When using BAM input (\-abam), write output as BEDPE. The default is to write output in BAM when using \-abam. For example: pairToBed ?Cabam reads.bam ?Cb genes.bed ?Cbedpe
T}
_
T{
\fB\-ed\fP
T}	T{
Use BAM total edit distance (NM tag) for BEDPE score. Default for BEDPE is to use the \fIminimum\fP of the two mapping qualities for the pair. When \-ed is used the \fItotal\fP edit distance from the two mates is reported as the score.
T}
_
T{
\fB\-f\fP
T}	T{
Minimum overlap required as a fraction of A. Default is 1E\-9 (i.e. 1bp).
T}
_
T{
\fB\-s\fP
T}	T{
Force "strandedness". That is, only report hits in B that overlap A on the \fBsame\fP strand. By default, overlaps are reported without respect to strand.
T}
_
T{
\fB\-type\fP
T}	T{
Approach to reporting overlaps between BEDPE and BED.
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.INDENT 3.5
\fBeither\-\fP Report overlaps if either end of A overlaps B.
.INDENT 0.0
.IP \(bu 2
\fIDefault\fP
.UNINDENT
.sp
\fBneither\-\fP Report A if neither end of A overlaps B.
.sp
\fBxor\-\fP Report overlaps if one and only one end of A overlaps B.
.sp
\fBboth\-\fP Report overlaps if both ends of A overlap B.
.sp
\fBnotboth\-\fP Report overlaps if neither end or one and only one end of A overlap B.
.sp
\fBispan\-\fP Report overlaps between [end1, start2] of A and B.
.INDENT 0.0
.IP \(bu 2
Note: If chrom1 <> chrom2, entry is ignored.
.UNINDENT
.UNINDENT
.UNINDENT
.sp
\fBospan\-\fP Report overlaps between [start1, end2] of A and B.
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.IP \(bu 2
Note: If chrom1 <> chrom2, entry is ignored.
.UNINDENT
.sp
\fBnotispan\-\fP  Report A if ispan of A doesn\(aqt overlap B.
\- Note: If chrom1 <> chrom2, entry is ignored.
.sp
\fBnotospan\-\fP  Report A if ospan of A doesn\(aqt overlap B.
\- Note: If chrom1 <> chrom2, entry is ignored.
.UNINDENT
.UNINDENT
.UNINDENT
.UNINDENT
T}
_
.TE
.SS 5.2.2 Default behavior
.sp
By default, a BEDPE / BAM feature will be reported if \fIeither\fP end overlaps a feature in the BED file.
In the example below, the left end of the pair overlaps B yet the right end does not. Thus, BEDPE/
BAM A is reported since the default is to report A if either end overlaps B.
.sp
Default: Report A if \fIeither\fP end overlaps B.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         *****.................................*****

BED File B         ^^^^^^^^                                          ^^^^^^

Result              =====.................................=====
.ft P
.fi
.SS 5.2.3 (\-type)Optional overlap requirements
.sp
Using then \fB\-type\fP option, \fBpairToBed\fP provides several other overlap requirements for controlling how
overlaps between BEDPE/BAM A and BED B are reported. The examples below illustrate how each
option behaves.
.sp
\fB\-type both\fP: Report A only if \fIboth\fP ends overlap B.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         *****.................................*****

BED File B         ^^^^^^^^                                          ^^^^^^

Result



BEDPE/BAM A         *****.................................*****

BED File B         ^^^^^^^^                                   ^^^^^^

Result              =====.................................=====
.ft P
.fi
.sp
\fB\-type neither\fP: Report A only if \fIneither\fP end overlaps B.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         *****.................................*****

BED File B         ^^^^^^^^                                          ^^^^^^

Result



BEDPE/BAM A         *****.................................*****

BED File B   ^^^^                                                  ^^^^^^

Result              =====.................................=====
.ft P
.fi
.sp
\fB\-type xor\fP: Report A only if \fIone and only one\fP end overlaps B.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         *****.................................*****

BED File B         ^^^^^^^^                                          ^^^^^^

Result              =====.................................=====



BEDPE/BAM A         *****.................................*****

BED File B         ^^^^                                   ^^^^^^

Result
.ft P
.fi
.sp
\fB\-type notboth\fP: Report A only if \fIneither end\fP \fBor\fP \fIone and only one\fP end overlaps B. Thus "notboth"
includes what would be reported by "neither" and by "xor".
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         *****.................................*****

BED File B         ^^^^^^^^                                          ^^^^^^

Result              =====.................................=====



BEDPE/BAM A         *****.................................*****

BED File B     ^^^                                               ^^^^^^

Result              =====.................................=====



BEDPE/BAM A         *****.................................*****

BED File B         ^^^^                                   ^^^^^^

Result
.ft P
.fi
.sp
\fB\-type ispan\fP: Report A if it\(aqs "\fIinner span\fP" overlaps B. Applicable only to intra\-chromosomal features.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

              Inner span |\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-|

BEDPE/BAM A         *****.................................*****

BED File B                         ^^^^^^^^

Result              =====.................................=====



BEDPE/BAM A         =====.................................=====

BED File B         ====

Result
.ft P
.fi
.sp
\fB\-type ospan\fP: Report A if it\(aqs "\fIouter span\fP" overlaps B. Applicable only to intra\-chromosomal features.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

        Outer span  |\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-|

BEDPE/BAM A         *****.................................*****

BED File B             ^^^^^^^^^^^^

Result              =====.................................=====



BEDPE/BAM A         *****.................................*****

BED File B     ^^^^

Result
.ft P
.fi
.sp
\fB\-type notispan\fP: Report A only if it\(aqs "\fIinner span\fP" does not overlap B. Applicable only to intrachromosomal
features.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

              Inner span |\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-|

BEDPE/BAM A         *****.................................*****

BED File B                         ^^^^^^^^

Result



BEDPE/BAM A         *****.................................*****

BED File B         ^^^^

Result              =====.................................=====
.ft P
.fi
.sp
\fB\-type notospan\fP: Report A if it\(aqs "\fIouter span\fP" overlaps B. Applicable only to intra\-chromosomal
features.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

        Outer span  |\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-|

BEDPE/BAM A         *****.................................*****

BED File B             ^^^^^^^^^^^^

Result



BEDPE/BAM A         *****.................................*****

BED File B     ^^^^

Result              =====.................................=====
.ft P
.fi
.SS 5.2.4 (\-f)Requiring a minimum overlap fraction
.sp
By default, \fBpairToBed\fP will report an overlap between A and B so long as there is at least one base
pair is overlapping on either end. Yet sometimes you may want to restrict reported overlaps between A
and B to cases where the feature in B overlaps at least X% (e.g. 50%) of A. The \fB?Cf\fP option does exactly
this. The \fB\-f\fP option may also be combined with the \-type option for additional control. For example,
combining \fB\-f 0.50\fP with \fB\-type both\fP requires that both ends of A have at least 50% overlap with a
feature in B.
.sp
For example, report A only at least 50% of one of the two ends is overlapped by B.
.sp
.nf
.ft C
pairToBed \-a A.bedpe \-b B.bed \-f 0.5


Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         *****.................................*****

BED File B         ^^                                           ^^^^^^

Result



BEDPE/BAM A         *****.................................*****

BED File B         ^^^^                                         ^^^^^^

Result              =====.................................=====
.ft P
.fi
.SS 5.2.5 (\-s)Enforcing "strandedness"
.sp
By default, \fBpairToBed\fP will report overlaps between features even if the features are on opposing
strands. However, if strand information is present in both files and the \fB"\-s"\fP option is used, overlaps will
only be reported when features are on the same strand.
.sp
For example, report A only at least 50% of one of the two ends is overlapped by B.
.sp
.nf
.ft C
pairToBed \-a A.bedpe \-b B.bed \-s



Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         >>>>>.................................<<<<<

BED File B         <<                                           >>>>>

Result



BEDPE/BAM A         >>>>>.................................<<<<<

BED File B         >>                                          >>>>>

Result              >>>>>.................................<<<<<
.ft P
.fi
.SS 5.2.6 (\-abam)Default is to write BAM output when using BAM input
.sp
When comparing \fIpaired\fP alignments in BAM format (\fB\-abam\fP) to features in BED format (\fB\-b\fP),
\fBpairToBed\fP will , by default, write the output in BAM format. That is, each alignment in the BAM
file that meets the user\(aqs criteria will be written (to standard output) in BAM format. This serves as a
mechanism to create subsets of BAM alignments are of biological interest, etc. Note that both
alignments for each aligned pair will be written to the BAM output.
.sp
For example:
.sp
.nf
.ft C
pairToBed ?Cabam pairedReads.bam ?Cb simreps.bed | samtools view \- | head \-4

JOBU_0001:3:1:4:1060#0 99 chr10 42387928 29 50M = 42393091 5 2 1 3
AA A A A C G G A A T T A T C G A A T G G A A T C G A A G A G A A T C T T C G A A C G G A C C C G A
dcgggggfbgfgdgggggggfdfgggcggggfcggcggggggagfgbggc XT:A:R NM:i:5 SM:i:0 AM:i:0 X0:i:3 X 1 : i :
3 XM:i:5 XO:i:0 XG:i:0 MD:Z:0T0C33A5T4T3
JOBU_0001:3:1:4:1060#0 147 chr10 42393091 0 50M = 42387928 \- 5 2 1 3
AAATGGAATCGAATGGAATCAACATCAAATGGAATCAAATGGAATCATTG K g d c g g d e c d g
\ed\(gaggfcgcggffcgggc^cgfgccgggfc^gcdgg\ebg XT:A:R NM:i:2 SM:i:0 AM:i:0 X0:i:3 X1:i:13 XM:i:2 X O : i :
0 XG:i:0 MD:Z:21T14G13
JOBU_0001:3:1:8:446#0 99 chr10 42388091 9 50M = 42392738 4 6 9 7
GAATCGACTGGAATCATCATCGGATGGAAATGAATGGAATAATCATCGAA f _ O f f \(ga ] I e Y f f \(ga f f e d d c f e f c P \(ga c _ W \e \e R _ ]
_BBBBBBBBBBBBBBBB XT:A:U NM:i:4 SM:i:0 AM:i:0 X0:i:1 X1:i:3 XM:i:4 XO:i:0 XG:i:0 M D : Z :
7A22C9C2T6
JOBU_0001:3:1:8:446#0 147 chr10 42392738 9 50M = 42388091 \- 4 6 9 7
TTATCGAATGCAATCGAATGGAATTATCGAATGCAATCGAATAGAATCAT df^ffec_JW[\(gaMWceRec\(ga\(gafee\(gadcecfeeZae\(gac]
f^cNeecfccf^ XT:A:R NM:i:1 SM:i:0 AM:i:0 X0:i:2 X1:i:2 XM:i:1 XO:i:0 XG:i:0 MD:Z:38A11
.ft P
.fi
.SS 5.2.7 (\-bedpe)Output BEDPE format when using BAM input
.sp
When comparing \fIpaired\fP alignments in BAM format (\fB\-abam\fP) to features in BED format (\fB\-b\fP),
\fBpairToBed\fP will optionally write the output in BEDPE format. That is, each alignment in the BAM
file is converted to a 10 column BEDPE feature and if overlaps are found (or not) based on the user\(aqs
criteria, the BAM alignment will be reported in BEDPE format. The BEDPE "name" field is comprised
of the RNAME field in the BAM alignment. The "score" field is the mapping quality score from the
BAM alignment.
.sp
For example:
.sp
.nf
.ft C
pairToBed ?Cabam pairedReads.bam ?Cb simreps.bed \-bedpe | head \-5
chr10 42387927     42387977    chr10   42393090   42393140
      JOBU_0001:3:1:4:1060#0   29      +     \-
chr10 42388090 42388140        chr10   42392737   42392787
      JOBU_0001:3:1:8:446#0    9       +     \-
chr10 42390552 42390602        chr10   42396045   42396095
      JOBU_0001:3:1:10:1865#0  9       +     \-
chrX  139153741 139153791      chrX    139159018  139159068
      JOBU_0001:3:1:14:225#0   37      +     \-
chr4  9236903 9236953          chr4    9242032    9242082
      JOBU_0001:3:1:15:1362#0  0       +     \-
.ft P
.fi
.SS 5.3 pairToPair
.sp
\fBpairToPair\fP compares two BEDPE files in search of overlaps where each end of a BEDPE feature in A
overlaps with the ends of a feature in B. For example, using pairToPair, one could screen for the exact
same discordant paired\-end alignment in two files. This could suggest (among other things) that the
discordant pair suggests the same structural variation in each file/sample.
.SS 5.3.1 Usage and option summary
.sp
\fBUsage:\fP
.sp
.nf
.ft C
pairToPair [OPTIONS] \-a <BEDPE> \-b <BEDPE>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-a\fP
T}	T{
BEDPE file A. Each feature in A is compared to B in search of overlaps. Use "stdin" if passing A with a UNIX pipe.
T}
_
T{
\fB\-b\fP
T}	T{
BEDPE file B. Use "stdin" if passing B with a UNIX pipe.
T}
_
T{
\fB\-f\fP
T}	T{
Minimum overlap required as a fraction of A. Default is 1E\-9 (i.e. 1bp).
T}
_
T{
\fB\-is\fP
T}	T{
Force "strandedness". That is, only report hits in B that overlap A on the same strand. By default, overlaps are reported without respect to strand.
T}
_
T{
\fB\-type\fP
T}	T{
.INDENT 0.0
.INDENT 3.5
Approach to reporting overlaps between BEDPE and BED.
.UNINDENT
.UNINDENT
.nf
\fBeither\fP Report overlaps if either ends of A overlap B.
.fi
.sp
.INDENT 0.0
.INDENT 3.5
.nf
\fBneither\fP Report A if neither end of A overlaps B.
.fi
.sp
.nf
\fBboth\fP Report overlaps if both ends of A overlap B.   \-\fIDefault behavior.\fP
.fi
.sp
.UNINDENT
.UNINDENT
T}
_
.TE
.SS 5.3.2 Default behavior
.sp
By default, a BEDPE feature from A will be reported if \fIboth\fP ends overlap a feature in the BEDPE B
file. If strand information is present for the two BEDPE files, it will be further required that the
overlaps on each end be on the same strand. This way, an otherwise overlapping (in terms of genomic
locations) F/R alignment will not be matched with a R/R alignment.
.sp
Default: Report A if \fIboth\fP ends overlaps B.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         *****.................................*****

BED File B         ^^^^^^^^                                          ^^^^^^

Result              =====.................................=====
.ft P
.fi
.sp
Default when strand information is present in both BEDPE files: Report A if \fIboth\fP ends overlaps B \fIon
the same strands\fP.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE A         >>>>>.................................>>>>>

BEDPE B            <<<<<.............................>>>>>

Result



BEDPE A         >>>>>.................................>>>>>

BEDPE B            >>>>>.............................>>>>>

Result          >>>>>.................................>>>>>
.ft P
.fi
.SS 5.3.3 (\-type neither)Optional overlap requirements
.sp
Using then \fB\-type neither, pairToPair\fP will only report A if \fIneither\fP end overlaps with a BEDPE
feature in B.
.sp
\fB\-type neither\fP: Report A only if \fIneither\fP end overlaps B.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BEDPE/BAM A         *****.................................*****

BED File B         ^^^^^^^^......................................^^^^^^

Result



BEDPE/BAM A         *****.................................*****

BED File B    ^^^^................................................^^^^^^

Result              =====.................................=====
.ft P
.fi
.SS 5.4 bamToBed
.sp
\fBbamToBed\fP is a general purpose tool that will convert sequence alignments in BAM format to either
BED6, BED12 or BEDPE format. This enables one to convert BAM files for use with all of the other
BEDTools. The CIGAR string is used to compute the alignment end coordinate in an "ungapped"
fashion. That is, match ("M"), deletion ("D"), and splice ("N") operations are observed when computing
alignment ends.
.SS 5.4.1 Usage and option summary
.sp
\fBUsage:\fP
.sp
.nf
.ft C
bamToBed [OPTIONS] \-i <BAM>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-bedpe\fP
T}	T{
.INDENT 0.0
.INDENT 3.5
.INDENT 0.0
.TP
.B Write BAM alignments in BEDPE format. Only one alignment from paired\-end reads will be reported. Specifically, it each mate is aligned to the same chromosome, the BAM alignment reported will be the one where the BAM insert size is greater than zero. When the mate alignments are interchromosomal, the lexicographically lower chromosome will be reported first. Lastly, when an end is unmapped, the chromosome and strand will be set to "." and the start and end coordinates will be set to \-1. \fIBy default, this is disabled and the output will be reported in BED format\fP.
\fBNOTE: When using this option, it is required that the BAM file is sorted/grouped by the read name. This allows bamToBed to extract correct alignment coordinates for each end based on their respective CIGAR strings. It also assumes that the alignments for a given pair come in groups of twos. There is not yet a standard method for reporting multiple alignments using BAM. bamToBed will fail if an aligner does not report alignments in pairs\fP.
.UNINDENT
.UNINDENT
.UNINDENT
.sp
BAM files may be piped to bamToBed by specifying "\-i stdin". See example below.
T}
_
T{
\fB\-bed12\fP
T}	T{
Write "blocked" BED (a.k.a. BED12) format. This will convert "spliced" BAM alignments (denoted by the "N" CIGAR operation) to BED12.
T}
_
T{
\fB\-ed\fP
T}	T{
Use the "edit distance" tag (NM) for the BED score field. Default for BED is to use mapping quality. Default for BEDPE is to use the \fIminimum\fP of the two mapping qualities for the pair. When \-ed is used with \-bedpe, the total edit distance from the two mates is reported.
T}
_
T{
\fB\-tag\fP
T}	T{
Use other \fInumeric\fP BAM alignment tag for BED score. Default for BED is to use mapping quality. Disallowed with BEDPE output.
T}
_
T{
\fB\-color\fP
T}	T{
An R,G,B string for the color used with BED12 format. Default is (255,0,0).
T}
_
T{
\fB\-split\fP
T}	T{
Report each portion of a "split" BAM (i.e., having an "N" CIGAR operation) alignment as a distinct BED intervals.
T}
_
.TE
.sp
By default, each alignment in the BAM file is converted to a 6 column BED. The BED "name" field is
comprised of the RNAME field in the BAM alignment. If mate information is available, the mate (e.g.,
"/1" or "/2") field will be appended to the name. The "score" field is the mapping quality score from the
BAM alignment, unless the \fB\-ed\fP option is used.
.sp
Examples:
.sp
.nf
.ft C
bamToBed \-i reads.bam | head \-5
chr7   118970079   118970129   TUPAC_0001:3:1:0:1452#0/1   37   \-
chr7   118965072   118965122   TUPAC_0001:3:1:0:1452#0/2   37   +
chr11  46769934    46769984    TUPAC_0001:3:1:0:1472#0/1   37   \-

bamToBed \-i reads.bam \-tag NM | head \-5
chr7   118970079   118970129   TUPAC_0001:3:1:0:1452#0/1   1    \-
chr7   118965072   118965122   TUPAC_0001:3:1:0:1452#0/2   3    +
chr11  46769934    46769984    TUPAC_0001:3:1:0:1472#0/1   1    \-

bamToBed \-i reads.bam \-bedpe | head \-3
chr7   118965072   118965122   chr7   118970079   118970129
       TUPAC_0001:3:1:0:1452#0 37     +     \-
chr11  46765606    46765656    chr11  46769934    46769984
       TUPAC_0001:3:1:0:1472#0 37     +     \-
chr20  54704674    54704724    chr20  54708987    54709037
       TUPAC_0001:3:1:1:1833#0 37     +
.ft P
.fi
.sp
One can easily use samtools and bamToBed together as part of a UNIX pipe. In this example, we will
only convert properly\-paired (BAM flag == 0x2) reads to BED format.
.sp
.nf
.ft C
samtools view \-bf 0x2 reads.bam | bamToBed \-i stdin | head
chr7   118970079   118970129   TUPAC_0001:3:1:0:1452#0/1   37   \-
chr7   118965072   118965122   TUPAC_0001:3:1:0:1452#0/2   37   +
chr11  46769934    46769984    TUPAC_0001:3:1:0:1472#0/1   37   \-
chr11  46765606    46765656    TUPAC_0001:3:1:0:1472#0/2   37   +
chr20  54704674    54704724    TUPAC_0001:3:1:1:1833#0/1   37   +
chr20  54708987    54709037    TUPAC_0001:3:1:1:1833#0/2   37   \-
chrX   9380413     9380463     TUPAC_0001:3:1:1:285#0/1    0    \-
chrX   9375861     9375911     TUPAC_0001:3:1:1:285#0/2    0    +
chrX   131756978   131757028   TUPAC_0001:3:1:2:523#0/1    37   +
chrX   131761790   131761840   TUPAC_0001:3:1:2:523#0/2    37   \-
.ft P
.fi
.SS 5.4.2 (\-split)Creating BED12 features from "spliced" BAM entries.
.sp
bamToBed will, by default, create a BED6 feature that represents the entire span of a spliced/split
BAM alignment. However, when using the \fB\-split\fP command, a BED12 feature is reported where BED
blocks will be created for each aligned portion of the sequencing read.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Exons       ***************                                    **********

BED/BAM A      ^^^^^^^^^^^^....................................^^^^

Result      ===============                                    ====
.ft P
.fi
.SS 5.5 windowBed
.sp
Similar to \fBintersectBed\fP, \fBwindowBed\fP searches for overlapping features in A and B. However,
\fBwindowBed\fP adds a specified number (1000, by default) of base pairs upstream and downstream of
each feature in A. In effect, this allows features in B that are "near" features in A to be detected.
.SS 5.5.1 Usage and option summary
.sp
\fBUsage:\fP
.sp
.nf
.ft C
windowBed [OPTIONS] \-a <BED/GFF/VCF> \-b <BED/GFF/VCF>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-abam\fP
T}	T{
BAM file A. Each BAM alignment in A is compared to B in search of overlaps. Use "stdin" if passing A with a UNIX pipe: For example:  samtools view \-b <BAM> | windowBed \-abam stdin \-b genes.bed
T}
_
T{
\fB\-ubam\fP
T}	T{
Write uncompressed BAM output. The default is write compressed BAM output.
T}
_
T{
\fB\-bed\fP
T}	T{
When using BAM input (\-abam), write output as BED. The default is to write output in BAM when using \-abam. For example:  windowBed \-abam reads.bam \-b genes.bed \-bed
T}
_
T{
\fB\-w\fP
T}	T{
Base pairs added upstream and downstream of each entry in A when searching for overlaps in B. \fIDefault is 1000 bp\fP.
T}
_
T{
\fB\-l\fP
T}	T{
Base pairs added upstream (left of) of each entry in A when searching for overlaps in B. \fIAllows one to create assymetrical "windows". Default is 1000bp\fP.
T}
_
T{
\fB\-r\fP
T}	T{
Base pairs added downstream (right of) of each entry in A when searching for overlaps in B. \fIAllows one to create assymetrical "windows". Default is 1000bp\fP.
T}
_
T{
\fB\-sw\fP
T}	T{
Define \-l and \-r based on strand. For example if used, \-l 500 for a negative\-stranded feature will add 500 bp downstream. \fIBy default, this is disabled\fP.
T}
_
T{
\fB\-sm\fP
T}	T{
Only report hits in B that overlap A on the same strand. \fIBy default, overlaps are reported without respect to strand\fP.
T}
_
T{
\fB\-u\fP
T}	T{
Write original A entry once if any overlaps found in B. In other words, just report the fact at least one overlap was found in B.
T}
_
T{
\fB\-c\fP
T}	T{
For each entry in A, report the number of hits in B while restricting to \-f. Reports 0 for A entries that have no overlap with B.
T}
_
.TE
.SS 5.5.2 Default behavior
.sp
By default, \fBwindowBed\fP adds 1000 bp upstream and downstream of each A feature and searches for
features in B that overlap this "window". If an overlap is found in B, both the \fIoriginal\fP A feature and the
\fIoriginal\fP B feature are reported. For example, in the figure below, feature B1 would be found, but B2
would not.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                                      "window" = 10
BED File A                 <\-\-\-\-\-\-\-\-\-\-*************\-\-\-\-\-\-\-\-\-\->

BED File B            ^^^^^^^^                                          ^^^^^^

Result                ========
.ft P
.fi
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200

cat B.bed
chr1  500  1000
chr1  1300 2000

windowBed \-a A.bed \-b B.bed
chr1  100  200  chr1  500  1000
.ft P
.fi
.SS 5.5.3 (\-w)Defining a custom window size
.sp
Instead of using the default window size of 1000bp, one can define a custom, \fIsymmetric\fP window around
each feature in A using the \fB\-w\fP option. One should specify the window size in base pairs. For example,
a window of 5kb should be defined as \fB\-w 5000\fP.
.sp
For example (note that in contrast to the default behavior, the second B entry is reported):
.sp
.nf
.ft C
cat A.bed
chr1  100  200

cat B.bed
chr1  500  1000
chr1  1300 2000

windowBed \-a A.bed \-b B.bed \-w 5000
chr1  100  200  chr1  500   1000
chr1  100  200  chr1  1300  2000
.ft P
.fi
.SS 5.5.4 (\-l and \-r)Defining assymteric windows
.sp
One can also define asymmetric windows where a differing number of bases are added upstream and
downstream of each feature using the \fB\-l (upstream)\fP and \fB\-r (downstream)\fP options.
.sp
For example (note the difference between \-l 200 and \-l 300):
.sp
.nf
.ft C
cat A.bed
chr1  1000  2000

cat B.bed
chr1  500   800
chr1  10000 20000

windowBed \-a A.bed \-b B.bed \-l 200 \-r 20000
chr1  100   200  chr1  10000  20000

windowBed \-a A.bed \-b B.bed \-l 300 \-r 20000
chr1  100   200  chr1  500    800
chr1  100   200  chr1  10000  20000
.ft P
.fi
.SS 5.5.5 (\-sw)Defining assymteric windows based on strand
.sp
Especially when dealing with gene annotations or RNA\-seq experiments, you may want to define
asymmetric windows based on "strand". For example, you may want to screen for overlaps that occur
within 5000 bp upstream of a gene (e.g. a promoter region) while screening only 1000 bp downstream of
the gene. By enabling the \fB\-sw\fP ("stranded" windows) option, the windows are added upstream or
downstream according to strand. For example, imagine one specifies \fB\-l 5000 \-r 1000\fP as well as the \fB\-
sw\fP option. In this case, forward stranded ("+") features will screen 5000 bp to the \fIleft\fP (that is, \fIlower\fP
genomic coordinates) and 1000 bp to the \fIright\fP (that is, \fIhigher\fP genomic coordinates). By contrast,
reverse stranded ("\-") features will screen 5000 bp to the \fIright\fP (that is, \fIhigher\fP genomic coordinates) and
1000 bp to the \fIleft\fP (that is, \fIlower\fP genomic coordinates).
.sp
For example (note the difference between \-l 200 and \-l 300):
.sp
.nf
.ft C
cat A.bed
chr1  10000  20000  A.forward  1  +
chr1  10000  20000  A.reverse  1  \-

cat B.bed
chr1  1000   8000   B1
chr1  24000  32000  B2

windowBed \-a A.bed \-b B.bed \-l 5000 \-r 1000 \-sw
chr1  10000  20000  A.forward  1  +  chr1  1000   8000   B1
chr1  10000  20000  A.reverse  1  \-  chr1  24000  32000  B2
.ft P
.fi
.SS 5.5.6 (\-sm)Enforcing "strandedness"
.sp
This option behaves the same as the \-s option for intersectBed while scanning for overlaps within the
"window" surrounding A. See the discussion in the intersectBed section for details.
.SS 5.5.7 (\-u)Reporting the presence of at least one overlapping feature
.sp
This option behaves the same as for intersectBed while scanning for overlaps within the "window"
surrounding A. See the discussion in the intersectBed section for details.
.SS 5.5.8 (\-c)Reporting the number of overlapping features
.sp
This option behaves the same as for intersectBed while scanning for overlaps within the "window"
surrounding A. See the discussion in the intersectBed section for details.
.SS 5.5.9 (\-v)Reporting the absence of any overlapping features
.sp
This option behaves the same as for intersectBed while scanning for overlaps within the "window"
surrounding A. See the discussion in the intersectBed section for details.
.SS 5.6 closestBed
.sp
Similar to \fBintersectBed, closestBed\fP searches for overlapping features in A and B. In the event that
no feature in B overlaps the current feature in A, \fBclosestBed\fP will report the \fIclosest\fP (that is, least
genomic distance from the start or end of A) feature in B. For example, one might want to find which
is the closest gene to a significant GWAS polymorphism. Note that \fBclosestBed\fP will report an
overlapping feature as the closest\-\-\-that is, it does not restrict to closest \fInon\-overlapping\fP feature.
.SS 5.6.1 Usage and option summary
.sp
\fBUsage:\fP
.sp
.nf
.ft C
closestBed [OPTIONS] \-a <BED/GFF/VCF> \-b <BED/GFF/VCF>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-s\fP
T}	T{
Force strandedness. That is, find the closest feature in B overlaps A on the same strand. \fIBy default, this is disabled\fP.
T}
_
T{
\fB\-d\fP
T}	T{
In addition to the closest feature in B, report its distance to A as an extra column. The reported distance for overlapping features will be 0.
T}
_
T{
\fB\-t\fP
T}	T{
How ties for closest feature should be handled. This occurs when two features in B have exactly the same overlap with a feature in A. \fIBy default, all such features in B are reported\fP.
.INDENT 0.0
.INDENT 3.5
Here are the other choices controlling how ties are handled:
.sp
\fIall\-\fP   Report all ties (default).
.sp
\fIfirst\-\fP   Report the first tie that occurred in the B file.
.sp
\fIlast\-\fP   Report the last tie that occurred in the B file.
.UNINDENT
.UNINDENT
T}
_
.TE
.SS 5.6.2 Default behavior
.sp
\fBclosestBed\fP first searches for features in B that overlap a feature in A. If overlaps are found, the feature
in B that overlaps the highest fraction of A is reported. If no overlaps are found, \fBclosestBed\fP looks for
the feature in B that is \fIclosest\fP (that is, least genomic distance to the start or end of A) to A. For
example, in the figure below, feature B1 would be reported as the closest feature to A1.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BED FILE A                             *************

BED File B         ^^^^^^^^                            ^^^^^^

Result                                                 ======
.ft P
.fi
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200

cat B.bed
chr1  500  1000
chr1  1300 2000

closestBed \-a A.bed \-b B.bed
chr1  100  200  chr1  500  1000
.ft P
.fi
.SS 5.6.3 (\-s)Enforcing "strandedness"
.sp
This option behaves the same as the \-s option for intersectBed while scanning for the closest
(overlapping or not) feature in B. See the discussion in the intersectBed section for details.
.SS 5.6.4 (\-t)Controlling how ties for "closest" are broken
.sp
When there are two or more features in B that overlap the \fIsame fraction\fP of A, \fBclosestBed\fP will, by
default, report both features in B. Imagine feature A is a SNP and file B contains genes. It can often
occur that two gene annotations (e.g. opposite strands) in B will overlap the SNP. As mentioned, the
default behavior is to report both such genes in B. However, the \-t option allows one to optionally
choose the just first or last feature (in terms of where it occurred in the input file, not chromosome
position) that occurred in B.
.sp
For example (note the difference between \-l 200 and \-l 300):
.sp
.nf
.ft C
cat A.bed
chr1  100  101  rs1234

cat B.bed
chr1  0  1000  geneA  100  +
chr1  0  1000  geneB  100  \-

closestBed \-a A.bed \-b B.bed
chr1  100  101  rs1234  chr1  0  1000  geneA  100  +
chr1  100  101  rs1234  chr1  0  1000  geneB  100  \-

closestBed \-a A.bed \-b B.bed \-t all
chr1  100  101  rs1234  chr1  0  1000  geneA  100  +
chr1  100  101  rs1234  chr1  0  1000  geneB  100  \-

closestBed \-a A.bed \-b B.bed \-t first
chr1  100  101  rs1234  chr1  0  1000  geneA  100  +

closestBed \-a A.bed \-b B.bed \-t last
chr1  100  101  rs1234  chr1  0  1000  geneB  100  \-
.ft P
.fi
.SS 5.6.5 (\-d)Reporting the distance to the closest feature in base pairs
.sp
ClosestBed will optionally report the distance to the closest feature in the B file using the \fB\-d\fP option.
When a feature in B overlaps a feature in A, a distance of 0 is reported.
.sp
.nf
.ft C
cat A.bed
chr1  100  200
chr1  500  600

cat B.bed
chr1  500  1000
chr1  1300 2000

closestBed \-a A.bed \-b B.bed \-d
chr1  100  200  chr1  500  1000  300
chr1  500  600  chr1  500  1000  0
.ft P
.fi
.SS 5.7 subtractBed
.sp
\fBsubtractBed\fP searches for features in B that overlap A. If an overlapping feature is found in B, the
overlapping portion is removed from A and the remaining portion of A is reported. If a feature in B
overlaps all of a feature in A, the A feature will not be reported.
.SS 5.7.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
subtractBed [OPTIONS] \-a <BED/GFF/VCF> \-b <BED/GFF/VCF>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-f\fP
T}	T{
Minimum overlap required as a fraction of A. Default is 1E\-9 (i.e. 1bp).
T}
_
T{
\fB\-s\fP
T}	T{
Force strandedness. That is, find the closest feature in B overlaps A on the same strand.  \fIBy default, this is disabled\fP.
T}
_
.TE
.SS 5.7.2 Default behavior
.sp
Figure:
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BED FILE A             *************            ******

BED File B         ^^^^^^^^                   ^^^^^^^^^^^

Result                     =========
.ft P
.fi
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200
chr1  10   20

cat B.bed
chr1  0    30
chr1  180  300

subtractBed \-a A.bed \-b B.bed
chr1  100  180
.ft P
.fi
.SS 5.7.3  (\-f)Requiring a minimal overlap fraction before subtracting
.sp
This option behaves the same as the \-f option for intersectBed. In this case, subtractBed will only
subtract an overlap with B if it covers at least the fraction of A defined by \-f. If an overlap is found,
but it does not meet the overlap fraction, the original A feature is reported without subtraction.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200

cat B.bed
chr1  180  300

subtractBed \-a A.bed \-b B.bed \-f 0.10
chr1  100  180

subtractBed \-a A.bed \-b B.bed \-f 0.80
chr1  100  200
.ft P
.fi
.SS 5.7.4 (\-s)Enforcing "strandedness"
.sp
This option behaves the same as the \-s option for intersectBed while scanning for features in B that
should be subtracted from A. See the discussion in the intersectBed section for details.
.SS 5.8 mergeBed
.sp
\fBmergeBed\fP combines overlapping or "book\-ended" (that is, one base pair away) features in a feature file
into a single feature which spans all of the combined features.
.SS 5.8.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
mergeBed [OPTIONS] \-i <BED/GFF/VCF>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-s\fP
T}	T{
Force strandedness. That is, only merge features that are the same strand. \fIBy default, this is disabled\fP.
T}
_
T{
\fB\-n\fP
T}	T{
Report the number of BED entries that were merged. \fI1 is reported if no merging occurred\fP.
T}
_
T{
\fB\-d\fP
T}	T{
Maximum distance between features allowed for features to be merged. \fIDefault is 0. That is, overlapping and/or book\-ended features are merged\fP.
T}
_
T{
\fB\-nms\fP
T}	T{
Report the names of the merged features separated by semicolons.
T}
_
.TE
.SS 5.8.2 Default behavior
.sp
Figure:
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BED FILE       *************   ***************   **********************
                       ********

Result         ===============================   ======================
.ft P
.fi
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200
chr1  180  250
chr1  250  500
chr1  501  1000

mergeBed \-i A.bed
chr1  100  500
chr1  501  1000
.ft P
.fi
.SS 5.8.3 (\-s)Enforcing "strandedness"
.sp
This option behaves the same as the \-s option for intersectBed while scanning for features that should
be merged. Only features on the same strand will be merged. See the discussion in the intersectBed
section for details.
.SS 5.8.4 (\-n)Reporting the number of features that were merged
.sp
The \-n option will report the number of features that were combined from the original file in order to
make the newly merged feature. If a feature in the original file was not merged with any other features,
a "1" is reported.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200
chr1  180  250
chr1  250  500
chr1  501  1000

mergeBed \-i A.bed \-n
chr1  100  500  3
chr1  501  1000 1
.ft P
.fi
.SS 5.8.5 (\-d)Controlling how close two features must be in order to merge
.sp
By default, only overlapping or book\-ended features are combined into a new feature. However, one can
force mergeBed to combine more distant features with the \-d option. For example, were one to set \-d to
1000, any features that overlap or are within 1000 base pairs of one another will be combined.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200
chr1  501  1000

mergeBed \-i A.bed
chr1  100  200
chr1  501  1000

mergeBed \-i A.bed \-d 1000
chr1  100  200  1000
.ft P
.fi
.SS 5.8.6 (\-nms)Reporting the names of the features that were merged
.sp
Occasionally, one might like to know that names of the features that were merged into a new feature.
The \-nms option will add an extra column to the mergeBed output which lists (separated by
semicolons) the names of the merged features.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200  A1
chr1  150  300  A2
chr1  250  500  A3

mergeBed \-i A.bed \-nms
chr1  100  500  A1;A2;A3
.ft P
.fi
.SS 5.9 coverageBed
.sp
\fBcoverageBed\fP computes both the \fIdepth\fP and \fIbreadth\fP of coverage of features in file A across the features
in file B. For example, \fBcoverageBed\fP can compute the coverage of sequence alignments (file A) across 1
kilobase (arbitrary) windows (file B) tiling a genome of interest. One advantage that \fBcoverageBed\fP
offers is that it not only \fIcounts\fP the number of features that overlap an interval in file B, it also
computes the fraction of bases in B interval that were overlapped by one or more features. Thus,
\fBcoverageBed\fP also computes the \fIbreadth\fP of coverage for each interval in B.
.SS 5.9.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
coverageBed [OPTIONS] \-a <BED/GFF/VCF> \-b <BED/GFF/VCF>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-abam\fP
T}	T{
.INDENT 0.0
.INDENT 3.5
BAM file A. Each BAM alignment in A is compared to B in search of overlaps. Use "stdin" if passing A with a UNIX pipe: For example:
.UNINDENT
.UNINDENT
.nf
samtools view \-b <BAM> | intersectBed \-abam stdin \-b genes.bed
.fi
T}
_
T{
\fB\-s\fP
T}	T{
Force strandedness. That is, only features in A are only counted towards coverage in B if they are the same strand. \fIBy default, this is disabled and coverage is counted without respect to strand\fP.
T}
_
T{
\fB\-hist\fP
T}	T{
Report a histogram of coverage for each feature in B as well as a summary histogram for _all_ features in B.
.nf
Output (tab delimited) after each feature in B:
.fi
.sp
.INDENT 0.0
.INDENT 3.5
.nf
1) depth
2) # bases at depth
3) size of B
4) % of B at depth
.fi
.sp
.UNINDENT
.UNINDENT
T}
_
T{
\fB\-d\fP
T}	T{
Report the depth at each position in each B feature. Positions reported are one based. Each position and depth follow the complete B feature.
T}
_
T{
\fB\-split\fP
T}	T{
Treat "split" BAM or BED12 entries as distinct BED intervals when computing coverage. For BAM files, this uses the CIGAR "N" and "D" operations to infer the blocks for computing coverage. For BED12 files, this uses the BlockCount, BlockStarts, and BlockEnds fields (i.e., columns 10,11,12).
T}
_
.TE
.SS 5.9.2 Default behavior
.sp
After each interval in B, \fBcoverageBed\fP will report:
.INDENT 0.0
.IP 1. 3
The number of features in A that overlapped (by at least one base pair) the B interval.
.IP 2. 3
The number of bases in B that had non\-zero coverage from features in A.
.IP 3. 3
The length of the entry in B.
.IP 4. 3
The fraction of bases in B that had non\-zero coverage from features in A.
.UNINDENT
.sp
Below are the number of features in A (N=...) overlapping B and fraction of bases in B with coverage.
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BED FILE B  ***************     ***************     ******    **************

BED File A  ^^^^ ^^^^              ^^             ^^^^^^^^^    ^^^ ^^ ^^^^
              ^^^^^^^^                                      ^^^^^ ^^^^^ ^^

Result      [  N=3, 10/15 ]     [  N=1, 2/16 ]     [N=1,6/6]   [N=5, 11/12 ]
.ft P
.fi
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  10  20
chr1  20  30
chr1  30  40
chr1  100 200

cat B.bed
chr1  0   100
chr1  100 200
chr2  0   100

coverageBed \-a A.bed \-b B.bed
chr1  0   100  3  30  100 0.3000000
chr1  100 200  1  100 100 1.0000000
chr2  0   100  0  0   100 0.0000000
.ft P
.fi
.SS 5.9.4 (\-s)Calculating coverage by strand
.sp
Use the "\fB\-s\fP" option if one wants to only count coverage if features in A are on the same strand as the
feature / window in B. This is especially useful for RNA\-seq experiments.
.sp
For example (note the difference in coverage with and without \fB\-s\fP:
.sp
.nf
.ft C
cat A.bed
chr1  10  20  a1  1  \-
chr1  20  30  a2  1  \-
chr1  30  40  a3  1  \-
chr1  100 200 a4  1  +

cat B.bed
chr1  0   100 b1  1  +
chr1  100 200 b2  1  \-
chr2  0   100 b3  1  +

coverageBed \-a A.bed \-b B.bed
chr1  0   100 b1  1  +  3  30  100  0.3000000
chr1  100 200 b2  1  \-  1  100 100  1.0000000
chr2  0   100 b3  1  +  0  0   100  0.0000000

coverageBed \-a A.bed \-b B.bed \-s
chr1  0   100 b1  1  +  0  0   100  0.0000000
chr1  100 200 b2  1  \-  0  0   100  0.0000000
chr2  0   100 b3  1  +  0  0   100  0.0000000
.ft P
.fi
.SS 5.9.5 (\-hist)Creating a histogram of coverage for each feature in the B file
.sp
One should use the "\fB\-hist\fP" option to create, for each interval in B, a histogram of coverage of the
features in A across B.
.sp
In this case, each entire feature in B will be reported, followed by the depth of coverage, the number of
bases at that depth, the size of the feature, and the fraction covered. After all of the features in B have
been reported, a histogram summarizing the coverage among all features in B will be reported.
.sp
.nf
.ft C
cat A.bed
chr1  10  20  a1  1  \-
chr1  20  30  a2  1  \-
chr1  30  40  a3  1  \-
chr1  100 200 a4  1  +

cat B.bed
chr1  0   100 b1  1  +
chr1  100 200 b2  1  \-
chr2  0   100 b3  1  +

coverageBed \-a A.bed \-b B.bed \-hist
chr1  0   100 b1  1  +  0  70  100  0.7000000
chr1  0   100 b1  1  +  1  30  100  0.3000000
chr1  100 200 b2  1  \-  1  100 100  1.0000000
chr2  0   100 b3  1  +  0  100 100  1.0000000
all   0   170 300 0.5666667
all   1   130 300 0.4333333
.ft P
.fi
.SS 5.9.6 (\-hist)Reporting the per\-base of coverage for each feature in the B file
.sp
One should use the "\fB\-d\fP" option to create, for each interval in B, a detailed list of coverage at each of the
positions across each B interval.
.sp
The output will consist of a line for each one\-based position in each B feature, followed by the coverage
detected at that position.
.sp
.nf
.ft C
cat A.bed
chr1  0  5
chr1  3  8
chr1  4  8
chr1  5  9

cat B.bed
chr1  0  10

coverageBed \-a A.bed \-b B.bed \-d
chr1  0  10  B  1  1
chr1  0  10  B  2  1
chr1  0  10  B  3  1
chr1  0  10  B  4  2
chr1  0  10  B  5  3
chr1  0  10  B  6  3
chr1  0  10  B  7  3
chr1  0  10  B  8  3
chr1  0  10  B  9  1
chr1  0  10  B  10 0
.ft P
.fi
.SS 5.9.7 (\-split)Reporting coverage with spliced alignments or blocked BED features
.sp
As described in section 1.3.19, coverageBed will, by default, screen for overlaps against the entire span
of a spliced/split BAM alignment or blocked BED12 feature. When dealing with RNA\-seq reads, for
example, one typically wants to only tabulate coverage for the portions of the reads that come from
exons (and ignore the interstitial intron sequence). The \fB\-split\fP command allows for such coverage to be
performed.
.SS 5.10 genomeCoverageBed
.sp
\fBgenomeCoverageBed\fP computes a histogram of feature coverage (e.g., aligned sequences) for a given
genome. Optionally, by using the \fB\-d\fP option, it will report the depth of coverage at \fIeach base\fP on each
chromosome in the genome file (\fB\-g\fP).
.SS 5.10.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
genomeCoverageBed [OPTIONS] \-i <BED> \-g <GENOME>
.ft P
.fi
.sp
NOTE: genomeCoverageBed requires that the input BED file be sorted by
chromosome. A simple sort \-k1,1 will suffice.
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-ibam\fP
T}	T{
.INDENT 0.0
.INDENT 3.5
BAM file as input for coverage. Each BAM alignment in A added to the total coverage for the genome. Use "stdin" if passing it with a UNIX pipe: For example:
.UNINDENT
.UNINDENT
.nf
samtools view \-b <BAM> | genomeCoverageBed \-ibam stdin \-g hg18.genome
.fi
T}
_
T{
\fB\-d\fP
T}	T{
Report the depth at each genome position. \fIDefault behavior is to report a histogram\fP.
T}
_
T{
\fB\-max\fP
T}	T{
Combine all positions with a depth >= max into a single bin in the histogram.
T}
_
T{
\fB\-bg\fP
T}	T{
Report depth in BedGraph format. For details, see: \fI\%http://genome.ucsc.edu/goldenPath/help/bedgraph.html\fP
T}
_
T{
\fB\-bga\fP
T}	T{
Report depth in BedGraph format, as above (i.e., \-bg). However with this option, regions with zero coverage are also reported. This allows one to quickly extract all regions of a genome with 0 coverage by applying: "grep \-w 0$" to the output.
T}
_
T{
\fB\-split\fP
T}	T{
Treat "split" BAM or BED12 entries as distinct BED intervals when computing coverage. For BAM files, this uses the CIGAR "N" and "D" operations to infer the blocks for computing coverage. For BED12 files, this uses the BlockCount, BlockStarts, and BlockEnds fields (i.e., columns 10,11,12).
T}
_
T{
\fB\-strand\fP
T}	T{
Calculate coverage of intervals from a specific strand. With BED files, requires at least 6 columns (strand is column 6).
T}
_
.TE
.SS 5.10.2 Default behavior
.sp
By default, \fBgenomeCoverageBed\fP will compute a histogram of coverage for the genome file provided.
The default output format is as follows:
1. chromosome (or entire genome)
2. depth of coverage from features in input file
3. number of bases on chromosome (or genome) with depth equal to column 2.
4. size of chromosome (or entire genome) in base pairs
5. fraction of bases on chromosome (or entire genome) with depth equal to column 2.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  10  20
chr1  20  30
chr2  0   500

cat my.genome
chr1  1000
chr2  500

genomeCoverageBed \-i A.bed \-g my.genome
chr1   0  980  1000  0.98
chr1   1  20   1000  0.02
chr2   1  500  500   1
genome 0  980  1500  0.653333
genome 1  520  1500  0.346667
.ft P
.fi
.SS 5.10.3 (\-max)Controlling the histogram\(aqs maximum depth
.sp
Using the \fB\-max\fP option, \fBgenomeCoverageBed\fP will "lump" all positions in the genome having feature
coverage greather than or equal to \fBmax\fP into the \fBmax\fP histogram bin. For example, if one sets \fB\-max\fP
equal to 50, the max depth reported in the output will be 50 and all positions with a depth >= 50 will
be represented in bin 50.
.SS 5.10.4 (\-d)Reporting "per\-base" genome coverage
.sp
Using the \fB\-d\fP option, \fBgenomeCoverageBed\fP will compute the depth of feature coverage for each base
on each chromosome in genome file provided.
.sp
The "per\-base" output format is as follows:
1. chromosome
2. chromosome position
3. depth (number) of features overlapping this chromosome position.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  10  20
chr1  20  30
chr2  0   500

cat my.genome
chr1  1000
chr2  500

genomeCoverageBed \-i A.bed \-g my.genome \-d | head \-15 | tail \-n 10
chr1  6  0
chr1  7  0
chr1  8  0
chr1  9  0
chr1  10 0
chr1  11 1
chr1  12 1
chr1  13 1
chr1  14 1
chr1  15 1
.ft P
.fi
.SS 5.1.13 (\-split)Reporting coverage with spliced alignments or blocked BED features
.sp
As described in section 1.3.19, genomeCoverageBed will, by default, screen for overlaps against the
entire span of a spliced/split BAM alignment or blocked BED12 feature. When dealing with RNA\-seq
reads, for example, one typically wants to only screen for overlaps for the portions of the reads that
come from exons (and ignore the interstitial intron sequence). The \fB\-split\fP command allows for such
overlaps to be performed.
.sp
For additional details, please visit the Usage From The Wild site and have a look at example 5,
contributed by Assaf Gordon.
.SS 5.11 fastaFromBed
.sp
\fBfastaFromBed\fP extracts sequences from a FASTA file for each of the intervals defined in a BED file.
The headers in the input FASTA file must exactly match the chromosome column in the BED file.
.SS 5.11.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
fastaFromBed [OPTIONS] \-fi <input FASTA> \-bed <BED/GFF/VCF> \-fo <output FASTA>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-name\fP
T}	T{
Use the "name" column in the BED file for the FASTA headers in the output FASTA file.
T}
_
T{
\fB\-tab\fP
T}	T{
Report extract sequences in a tab\-delimited format instead of in FASTA format.
T}
_
T{
\fB\-s\fP
T}	T{
Force strandedness. If the feature occupies the antisense strand, the sequence will be reverse complemented. \fIDefault: strand information is ignored\fP.
T}
_
.TE
.SS 5.11.2 Default behavior
.sp
\fBfastaFromBed\fP will extract the sequence defined by the coordinates in a BED interval and create a
new FASTA entry in the output file for each extracted sequence. By default, the FASTA header for each
extracted sequence will be formatted as follows: "<chrom>:<start>\-<end>".
.sp
For example:
.sp
.nf
.ft C
$ cat test.fa
>chr1
AAAAAAAACCCCCCCCCCCCCGCTACTGGGGGGGGGGGGGGGGGG

cat test.bed
chr1 5 10

fastaFromBed \-fi test.fa \-bed test.bed \-fo test.fa.out

cat test.fa.out
>chr1:5\-10
AAACC
.ft P
.fi
.SS 5.11.3 Using the BED "name" column as a FASTA header.
.sp
Using the \fB\-name\fP option, one can set the FASTA header for each extracted sequence to be the "name"
columns from the BED feature.
.sp
For example:
.sp
.nf
.ft C
cat test.fa
>chr1
AAAAAAAACCCCCCCCCCCCCGCTACTGGGGGGGGGGGGGGGGGG

cat test.bed
chr1 5 10 myseq

fastaFromBed \-fi test.fa \-bed test.bed \-fo test.fa.out \-name

cat test.fa.out
>myseq
AAACC
.ft P
.fi
.SS 5.11.4 Creating a tab\-delimited output file in lieu of FASTA output.
.sp
Using the \fB\-tab\fP option, the \fB\-fo\fP output file will be tab\-delimited instead of in FASTA format.
.sp
For example:
.sp
.nf
.ft C
cat test.fa
>chr1
AAAAAAAACCCCCCCCCCCCCGCTACTGGGGGGGGGGGGGGGGGG

cat test.bed
chr1 5 10 myseq

fastaFromBed \-fi test.fa \-bed test.bed \-fo test.fa.out.tab \-name \-tab

cat test.fa.out
myseq AAACC
.ft P
.fi
.SS 5.11.5 (\-s)Forcing the extracted sequence to reflect the requested strand
.sp
\fBfastaFromBed\fP will extract the sequence in the orientation defined in the strand column when the "\-s"
option is used.
.sp
For example:
.sp
.nf
.ft C
cat test.fa
>chr1
AAAAAAAACCCCCCCCCCCCCGCTACTGGGGGGGGGGGGGGGGGG

cat test.bed
chr1 20 25 forward 1 +
chr1 20 25 reverse 1 \-

fastaFromBed \-fi test.fa \-bed test.bed \-s \-name \-fo test.fa.out

cat test.fa.out
>forward
CGCTA
>reverse
TAGCG
.ft P
.fi
.SS 5.12 maskFastaFromBed
.sp
\fBmaskFastaFromBed\fP masks sequences in a FASTA file based on intervals defined in a feature file. The
headers in the input FASTA file must exactly match the chromosome column in the feature file. This
may be useful fro creating your own masked genome file based on custom annotations or for masking all
but your target regions when aligning sequence data from a targeted capture experiment.
.SS 5.12.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
maskFastaFromBed [OPTIONS] \-fi <input FASTA> \-bed <BED/GFF/VCF> \-fo <output FASTA>
.ft P
.fi
.sp
NOTE: The input and output FASTA files must be different.
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-soft\fP
T}	T{
Soft\-mask (that is, convert to lower\-case bases) the FASTA sequence. \fIBy default, hard\-masking (that is, conversion to Ns) is performed\fP.
T}
_
.TE
.SS 5.12.2 Default behavior
.sp
\fBmaskFastaFromBed\fP will mask a FASTA file based on the intervals in a BED file. The newly masked
FASTA file is written to the output FASTA file.
.sp
For example:
.sp
.nf
.ft C
cat test.fa
>chr1
AAAAAAAACCCCCCCCCCCCCGCTACTGGGGGGGGGGGGGGGGGG

cat test.bed
chr1 5 10

maskFastaFromBed \-fi test.fa \-bed test.bed \-fo test.fa.out

cat test.fa.out
>chr1
AAAAANNNNNCCCCCCCCCCGCTACTGGGGGGGGGGGGGGGGGG
.ft P
.fi
.SS 5.12.3 Soft\-masking the FASTA file.
.sp
Using the \fB\-soft\fP option, one can optionally "soft\-mask" the FASTA file.
.sp
For example:
.sp
.nf
.ft C
cat test.fa
>chr1
AAAAAAAACCCCCCCCCCCCCGCTACTGGGGGGGGGGGGGGGGGG

cat test.bed
chr1 5 10

maskFastaFromBed \-fi test.fa \-bed test.bed \-fo test.fa.out \-soft

cat test.fa.out
>chr1
AAAAAaaaccCCCCCCCCCCGCTACTGGGGGGGGGGGGGGGGGG
.ft P
.fi
.SS 5.13 shuffleBed
.sp
\fBshuffleBed\fP will randomly permute the genomic locations of a fearure file among a genome defined in a
genome file. One can also provide an "exclusions" BED/GFF/VCF file that lists regions where you do
not want the permuted features to be placed. For example, one might want to prevent features from
being placed in known genome gaps. \fBshuffleBed\fP is useful as a \fInull\fP basis against which to test the
significance of associations of one feature with another.
.SS 5.13.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
shuffleBed [OPTIONS] \-i <BED/GFF/VCF> \-g <GENOME>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-excl\fP
T}	T{
A BED file of coordinates in which features from \-i should \fInot\fP be placed (e.g., genome gaps).
T}
_
T{
\fB\-chrom\fP
T}	T{
Keep features in \-i on the same chromosome. Solely permute their location on the chromosome. \fIBy default, both the chromosome and position are randomly chosen\fP.
T}
_
T{
\fB\-seed\fP
T}	T{
Supply an integer seed for the shuffling. This will allow feature shuffling experiments to be recreated exactly as the seed for the pseudo\-random number generation will be constant. \fIBy default, the seed is chosen automatically\fP.
T}
_
.TE
.SS 5.13.2 Default behavior
.sp
By default, \fBshuffleBed\fP will reposition each feature in the input BED file on a random chromosome at a
random position. The size and strand of each feature are preserved.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  0  100  a1  1  +
chr1  0  1000 a2  2  \-

cat my.genome
chr1  10000
chr2  8000
chr3  5000
chr4  2000

shuffleBed \-i A.bed \-g my.genome
chr4  1498  1598  a1  1  +
chr3  2156  3156  a2  2  \-
.ft P
.fi
.SS 5.13.3 (\-chrom)Requiring that features be shuffled on the same chromosome
.sp
The "\fB\-chrom\fP" option behaves the same as the default behavior except that features are randomly
placed on the same chromosome as defined in the BED file.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  0  100  a1  1  +
chr1  0  1000 a2  2  \-

cat my.genome
chr1  10000
chr2  8000
chr3  5000
chr4  2000

shuffleBed \-i A.bed \-g my.genome \-chrom
chr1  9560  9660  a1  1  +
chr1  7258  8258  a2  2  \-
.ft P
.fi
.SS 5.13.4 Excluding certain genome regions from shuffleBed
.sp
One may want to prevent BED features from being placed in certain regions of the genome. For
example, one may want to exclude genome gaps from permutation experiment. The "\fB\-excl\fP" option
defines a BED file of regions that should be excluded. \fBshuffleBed\fP will attempt to permute the
locations of all features while adhering to the exclusion rules. However it will stop looking for an
appropriate location if it cannot find a valid spot for a feature after 1,000,000 tries.
.sp
For example (\fInote that the exclude file excludes all but 100 base pairs of the chromosome\fP):
.sp
.nf
.ft C
cat A.bed
chr1  0  100   a1  1  +
chr1  0  1000  a2  2  \-

cat my.genome
chr1  10000

cat exclude.bed
chr1  100  10000

shuffleBed \-i A.bed \-g my.genome \-excl exclude.bed
chr1  0  100  a1  1  +
Error, line 2: tried 1000000 potential loci for entry, but could not avoid excluded
regions. Ignoring entry and moving on.
.ft P
.fi
.sp
For example (\fInow the exclusion file only excludes the first 100 bases of the chromosome\fP):
.sp
.nf
.ft C
cat A.bed
chr1  0  100  a1  1  +
chr1  0  1000 a2  2  \-

cat my.genome
chr1  10000

cat exclude.bed
chr1  0  100

shuffleBed \-i A.bed \-g my.genome \-excl exclude.bed
chr1  147  247  a1  1  +
chr1  2441 3441 a2  2  \-
.ft P
.fi
.SS 5.13.5 Defining a "seed" for the random replacement.
.sp
\fBshuffleBed\fP uses a pseudo\-random number generator to permute the locations of BED features.
Therefore, each run should produce a different result. This can be problematic if one wants to exactly
recreate an experiment. By using the "\fB\-seed\fP" option, one can supply a custom integer seed for
\fBshuffleBed\fP. In turn, each execution of \fBshuffleBed\fP with the same seed and input files should produce
identical results.
.sp
For example (\fInote that the exclude file below excludes all but 100 base pairs of the chromosome\fP):
.sp
.nf
.ft C
cat A.bed
chr1 0 100 a1 1 +
chr1 0 1000 a2 2 \-

cat my.genome
chr1 10000

shuffleBed \-i A.bed \-g my.genome \-seed 927442958
chr1 6177 6277 a1 1 +
chr1 8119 9119 a2 2 \-

shuffleBed \-i A.bed \-g my.genome \-seed 927442958
chr1 6177 6277 a1 1 +
chr1 8119 9119 a2 2 \-

\&. . .

shuffleBed \-i A.bed \-g my.genome \-seed 927442958
chr1 6177 6277 a1 1 +
chr1 8119 9119 a2 2 \-
.ft P
.fi
.SS 5.14 slopBed
.sp
\fBslopBed\fP will increase the size of each feature in a feature file be a user\-defined number of bases. While
something like this could be done with an "\fBawk \(aq{OFS="t" print $1,$2\-<slop>,$3+<slop>}\(aq\fP",
\fBslopBed\fP will restrict the resizing to the size of the chromosome (i.e. no start < 0 and no end >
chromosome size).
.SS 5.14.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
slopBed [OPTIONS] \-i <BED/GFF/VCF> \-g <GENOME> [\-b or (\-l and \-r)]
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-b\fP
T}	T{
Increase the BED/GFF/VCF entry by the same number base pairs in each direction. \fIInteger\fP.
T}
_
T{
\fB\-l\fP
T}	T{
The number of base pairs to subtract from the start coordinate. \fIInteger\fP.
T}
_
T{
\fB\-r\fP
T}	T{
The number of base pairs to add to the end coordinate. \fIInteger\fP.
T}
_
T{
\fB\-s\fP
T}	T{
Define \-l and \-r based on strand. For example. if used, \-l 500 for a negative\-stranded feature, it will add 500 bp to the \fIend\fP coordinate.
T}
_
.TE
.SS 5.14.2 Default behavior
.sp
By default, \fBslopBed\fP will either add a fixed number of bases in each direction (\fB\-b\fP) or an asymmetric
number of bases in each direction (\fB\-l\fP and \fB\-r\fP).
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1 5 100
chr1 800 980

cat my.genome
chr1 1000

slopBed \-i A.bed \-g my.genome \-b 5
chr1 0 105
chr1 795 985

slopBed \-i A.bed \-g my.genome \-l 2 \-r 3
chr1 3 103
chr1 798 983
.ft P
.fi
.sp
However, if the requested number of bases exceeds the boundaries of the chromosome, \fBslopBed\fP will
"clip" the feature accordingly.
.sp
.nf
.ft C
cat A.bed
chr1  5   100
chr1  800 980

cat my.genome
chr1  1000

slopBed \-i A.bed \-g my.genome \-b 5000
chr1  0   1000
chr1  0   1000
.ft P
.fi
.SS 5.14.3 Resizing features according to strand
.sp
\fBslopBed\fP will optionally increase the size of a feature based on strand.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1 100 200 a1 1 +
chr1 100 200 a2 2 \-

cat my.genome
chr1 1000

slopBed  \-i A.bed \-g my.genome \-l 50 \-r 80 \-s
chr1 50  280 a1 1 +
chr1 20  250 a2 2 \-
.ft P
.fi
.SS 5.15 sortBed
.sp
\fBsortBed\fP sorts a feature file by chromosome and other criteria.
.SS 5.15.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
sortBed [OPTIONS] \-i <BED/GFF/VCF>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-sizeA\fP
T}	T{
Sort by feature size in ascending order.
T}
_
T{
\fB\-sizeD\fP
T}	T{
Sort by feature size in descending order.
T}
_
T{
\fB\-chrThenSizeA\fP
T}	T{
Sort by chromosome, then by feature size (asc).
T}
_
T{
\fB\-chrThenSizeD\fP
T}	T{
Sort by chromosome, then by feature size (desc).
T}
_
T{
\fB\-chrThenScoreA\fP
T}	T{
Sort by chromosome, then by score (asc).
T}
_
T{
\fB\-chrThenScoreD\fP
T}	T{
Sort by chromosome, then by score (desc).
T}
_
.TE
.SS 5.15.2 Default behavior
.sp
By default, \fBsortBed\fP sorts a BED file by chromosome and then by start position in ascending order.
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1 800 1000
chr1 80  180
chr1 1   10
chr1 750 10000

sortBed \-i A.bed
chr1 1   10
chr1 80  180
chr1 750 10000
chr1 800 1000
.ft P
.fi
.SS 5.15.3 Optional sorting behavior
.sp
\fBsortBed\fP will also sorts a BED file by chromosome and then by other criteria.
.sp
For example, to sort by chromosome and then by feature size (in descending order):
.sp
.nf
.ft C
cat A.bed
chr1 800 1000
chr1 80  180
chr1 1   10
chr1 750 10000

sortBed \-i A.bed \-sizeD
chr1 750 10000
chr1 800 1000
chr1 80  180
chr1 1   10
.ft P
.fi
.sp
\fBDisclaimer:\fP it should be noted that \fBsortBed\fP is merely a convenience utility, as the UNIX sort utility
will sort BED files more quickly while using less memory. For example, UNIX sort will sort a BED file
by chromosome then by start position in the following manner:
.sp
.nf
.ft C
sort \-k 1,1 \-k2,2 \-n a.bed
chr1 1   10
chr1 80  180
chr1 750 10000
chr1 800 1000
.ft P
.fi
.SS 5.16 linksBed
.sp
Creates an HTML file with links to an instance of the UCSC Genome Browser for all features /
intervals in a file. This is useful for cases when one wants to manually inspect through a large set of
annotations or features.
.SS 5.16.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
linksBed [OPTIONS] \-i <BED/GFF/VCF> > <HTML file>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-base\fP
T}	T{
The "basename" for the UCSC browser. \fIDefault: http://genome.ucsc.edu\fP
T}
_
T{
\fB\-org\fP
T}	T{
The organism (e.g. mouse, human). \fIDefault: human\fP
T}
_
T{
\fB\-db\fP
T}	T{
The genome build. \fIDefault: hg18\fP
T}
_
.TE
.SS 5.16.2 Default behavior
.sp
By default, \fBlinksBed\fP creates links to the public UCSC Genome Browser.
.sp
For example:
.sp
.nf
.ft C
head genes.bed
chr21 9928613  10012791  uc002yip.1 0  \-
chr21 9928613  10012791  uc002yiq.1 0  \-
chr21 9928613  10012791  uc002yir.1 0  \-
chr21 9928613  10012791  uc010gkv.1 0  \-
chr21 9928613  10061300  uc002yis.1 0  \-
chr21 10042683 10120796  uc002yit.1 0  \-
chr21 10042683 10120808  uc002yiu.1 0  \-
chr21 10079666 10120808  uc002yiv.1 0  \-
chr21 10080031 10081687  uc002yiw.1 0  \-
chr21 10081660 10120796  uc002yix.2 0  \-

linksBed \-i genes.bed > genes.html
.ft P
.fi
.sp
When genes.html is opened in a web browser, one should see something like the following, where each
link on the page is built from the features in genes.bed:
.SS 5.16.3 Creating HTML links to a local UCSC Browser installation
.sp
Optionally, \fBlinksBed\fP will create links to a local copy of the UCSC Genome Browser.
.sp
For example:
.sp
.nf
.ft C
head \-3 genes.bed
chr21 9928613 10012791 uc002yip.1 0 \-
chr21 9928613 10012791 uc002yiq.1 0 \-

linksBed \-i genes.bed \-base http://mirror.uni.edu > genes.html
.ft P
.fi
.sp
One can point the links to the appropriate organism and genome build as well:
.sp
.nf
.ft C
head \-3 genes.bed
chr21 9928613 10012791 uc002yip.1 0 \-
chr21 9928613 10012791 uc002yiq.1 0 \-

linksBed \-i genes.bed \-base http://mirror.uni.edu \-org mouse \-db mm9 > genes.html
.ft P
.fi
.SS 5.17 complementBed
.sp
\fBcomplementBed\fP returns the intervals in a genome that are not by the features in a feature file. An
example usage of this tool would be to return the intervals of the genome that are not annotated as a
repeat.
.SS 5.17.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
complementBed [OPTIONS] \-i <BED/GFF/VCF> \-g <GENOME>
.ft P
.fi
.sp
\fBNo additional options.\fP
.SS 5.17.2 Default behavior
.sp
Figure:
.sp
.nf
.ft C
Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

BED FILE A     *************   ***************     ******************

Result      ===             ===               =====                  =======
.ft P
.fi
.sp
For example:
.sp
.nf
.ft C
cat A.bed
chr1  100  200
chr1  400  500
chr1  500  800

cat my.genome
chr1  1000

complementBed \-i A.bed \-g my.genome
chr1  0    100
chr1  200  400
chr1  800  1000
.ft P
.fi
.SS 5.18 bedToBam
.sp
\fBbedToBam\fP converts features in a feature file to BAM format. This is useful as an efficient means of
storing large genome annotations in a compact, indexed format for visualization purposes.
.SS 5.18.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
bedToBam [OPTIONS] \-i <BED/GFF/VCF> \-g <GENOME> > <BAM>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-mapq\fP
T}	T{
Set a mapping quality (SAM MAPQ field) value for all BED entries. \fIDefault: 255\fP
T}
_
T{
\fB\-ubam\fP
T}	T{
Write uncompressed BAM output. The default is write compressed BAM output.
T}
_
T{
\fB\-bed12\fP
T}	T{
Indicate that the input BED file is in BED12 (a.k.a "blocked" BED) format. In this case, bedToBam will convert blocked BED features (e.g., gene annotaions) into "spliced" BAM alignments by creating an appropriate CIGAR string.
T}
_
.TE
.SS 5.18.2 Default behavior
.sp
The default behavior is to assume that the input file is in unblocked format. For example:
.sp
.nf
.ft C
head \-5 rmsk.hg18.chr21.bed
chr21 9719768  9721892  ALR/Alpha  1004  +
chr21 9721905  9725582  ALR/Alpha  1010  +
chr21 9725582  9725977  L1PA3 3288 +
chr21 9726021  9729309  ALR/Alpha  1051  +
chr21 9729320  9729809  L1PA3 3897 \-

bedToBam \-i rmsk.hg18.chr21.bed \-g human.hg18.genome > rmsk.hg18.chr21.bam

samtools view rmsk.hg18.chr21.bam | head \-5
ALR/Alpha  0   chr21 9719769  255  2124M *  0  0  *  *
ALR/Alpha  0   chr21 9721906  255  3677M *  0  0  *  *
L1PA3      0   chr21 9725583  255  395M  *  0  0  *  *
ALR/Alpha  0   chr21 9726022  255  3288M *  0  0  *  *
L1PA3      16  chr21 9729321  255  489M  *  0  0  *  *
.ft P
.fi
.SS 5.18.3 Creating "spliced" BAM entries from "blocked" BED features
.sp
Optionally, \fBbedToBam\fP will create spliced BAM entries from "blocked" BED features by using the
\-bed12 option. This will create CIGAR strings in the BAM output that will be displayed as "spliced"
alignments. The image illustrates this behavior, as the top track is a BAM representation (using
bedToBam) of a BED file of UCSC genes.
.sp
For example:
.sp
.nf
.ft C
bedToBam \-i knownGene.hg18.chr21.bed \-g human.hg18.genome \-bed12 > knownGene.bam

samtools view knownGene.bam | head \-2
uc002yip.1  16   chr21 9928614   2                       5                        5

298M1784N71M1411N93M3963N80M1927N106M3608N81M1769N62M11856N89M98N82M816N61M6910N65M
738N64M146N100M1647N120M6478N162M1485N51M6777N60M9274N54M880N54M1229N54M2377N54M112
68N58M2666N109M2885N158M     *   0  0  *  *
uc002yiq.1  16   chr21 9928614   2                       5                        5

298M1784N71M1411N93M3963N80M1927N106M3608N81M1769N62M11856N89M98N82M816N61M6910N65M
738N64M146N100M1647N120M6478N162M1485N51M6777N60M10208N54M1229N54M2377N54M11268N58M
2666N109M2885N158M       *   0   0  *  *
.ft P
.fi
.SS 5.19 overlap
.sp
\fBoverlap\fP computes the amount of overlap (in the case of positive values) or distance (in the case of
negative values) between feature coordinates occurring on the same input line and reports the result at
the end of the same line. In this way, it is a useful method for computing custom overlap scores from
the output of other BEDTools.
.SS 5.19.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
overlap [OPTIONS] \-i <input> \-cols s1,e1,s2,e2
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-i\fP
T}	T{
Input file. Use "stdin" for pipes.
T}
_
T{
\fB\-cols\fP
T}	T{
Specify the columns (1\-based) for the starts and ends of the features for which you\(aqd like to compute the overlap/distance. The columns must be listed in the following order: \fIstart1,end1,start2,end2\fP
T}
_
.TE
.SS 5.19.2 Default behavior
.sp
The default behavior is to compute the amount of overlap between the features you specify based on the
start and end coordinates. For example:
.sp
.nf
.ft C
windowBed \-a A.bed \-b B.bed \-w 10
chr1  10  20  A  chr1  15  25  B
chr1  10  20  C  chr1  25  35  D
.ft P
.fi
.sp
# Now let\(aqs say we want to compute the number of base pairs of overlap
# between the overlapping features from the output of windowBed.
.sp
.nf
.ft C
windowBed \-a A.bed \-b B.bed \-w 10 | overlap \-i stdin \-cols 2,3,6,7
chr1  10  20  A  chr1  15  25  B  5
chr1  10  20  C  chr1  25  35  D  \-5
.ft P
.fi
.SS 5.20 bedToIgv
.sp
\fBbedToIgv\fP creates an IGV (\fI\%http://www.broadinstitute.org/igv/\fP) batch script (see: \fI\%http://\fP
www.broadinstitute.org/igv/batch for details) such that a ??snapshot?? will be taken at each features in a
feature file. This is useful as an efficient means for quickly collecting images of primary data at several
loci for subsequent screening, etc.
.sp
\fBNOTE: One must use IGV version 1.5 or higher.\fP
.SS 5.20.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
bedToIgv [OPTIONS] \-i <BED/GFF/VCF> > <igv.batch>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-path\fP
T}	T{
The full path to which the IGV snapshots should be written. \fIDefault: ./\fP
T}
_
T{
\fB\-sess\fP
T}	T{
The full path to an existing IGV session file to be loaded prior to taking snapshots. \fIDefault is for no session to be loaded and the assumption is that you already have IGV open and loaded with your relevant data prior to running the batch script\fP.
T}
_
T{
\fB\-sort\fP
T}	T{
The type of BAM sorting you would like to apply to each image. \fBValid sorting options\fP: \fIbase, position, strand, quality, sample, and readGroup Default is to apply no sorting at all\fP.
T}
_
T{
\fB\-clps\fP
T}	T{
Collapse the aligned reads prior to taking a snapshot. \fIDefault is to not collapse\fP.
T}
_
T{
\fB\-name\fP
T}	T{
Use the "name" field (column 4) for each image\(aqs filename. \fIDefault is to use the "chr:start\-pos.ext"\fP.
T}
_
T{
\fB\-slop\fP
T}	T{
Number of flanking base pairs on the left & right of the image.
T}
_
T{
\fB\-img\fP
T}	T{
The type of image to be created. \fBValid options\fP: \fIpng, eps, svg Default is png\fP.
T}
_
.TE
.SS 5.20.2 Default behavior
.sp
Figure:
.sp
.nf
.ft C
bedToIgv \-i data/rmsk.hg18.chr21.bed | head \-9
snapshotDirectory ./
goto chr21:9719768\-9721892
snapshot chr21:9719768\-9721892.png
goto chr21:9721905\-9725582
snapshot chr21:9721905\-9725582.png
goto chr21:9725582\-9725977
snapshot chr21:9725582\-9725977.png
goto chr21:9726021\-9729309
snapshot chr21:9726021\-9729309.png
.ft P
.fi
.SS 5.20.3 Using a bedToIgv batch script within IGV.
.sp
Once an IGV batch script has been created with \fBbedToIgv\fP, it is simply a matter of running it from
within IGV.
.sp
For example, first create the batch script:
.sp
.nf
.ft C
bedToIgv \-i data/rmsk.hg18.chr21.bed > rmsk.igv.batch
.ft P
.fi
.sp
Then, open and launch the batch script from within IGV. This will immediately cause IGV to begin
taking snapshots of your requested regions.
.SS 5.21 bed12ToBed6
.sp
\fBbed12ToBed6\fP is a convenience tool that converts BED features in BED12 (a.k.a. "blocked" BED
features such as genes) to discrete BED6 features. For example, in the case of a gene with six exons,
bed12ToBed6 would create six separate BED6 features (i.e., one for each exon).
.SS 5.21.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
bed12ToBed6 [OPTIONS] \-i <BED12>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-i\fP
T}	T{
The BED12 file that should be split into discrete BED6 features. \fIUse "stdin" when using piped input\fP.
T}
_
.TE
.SS 5.21.2 Default behavior
.sp
Figure:
.sp
.nf
.ft C
head data/knownGene.hg18.chr21.bed | tail \-n 3
chr21 10079666  10120808   uc002yiv.1  0  \-  10081686  1 0 1 2 0 6 0 8
      0     4   528,91,101,215, 0,1930,39750,40927,
chr21 10080031  10081687   uc002yiw.1  0  \-  10080031  1 0 0 8 0 0 3 1
      0     2   200,91,    0,1565,
chr21 10081660  10120796   uc002yix.2  0  \-  10081660  1 0 0 8 1 6 6 0
      0     3   27,101,223,0,37756,38913,

head data/knownGene.hg18.chr21.bed | tail \-n 3 | bed12ToBed6 \-i stdin
chr21 10079666  10080194  uc002yiv.1 0  \-
chr21 10081596  10081687  uc002yiv.1 0  \-
chr21 10119416  10119517  uc002yiv.1 0  \-
chr21 10120593  10120808  uc002yiv.1 0  \-
chr21 10080031  10080231  uc002yiw.1 0  \-
chr21 10081596  10081687  uc002yiw.1 0  \-
chr21 10081660  10081687  uc002yix.2 0  \-
chr21 10119416  10119517  uc002yix.2 0  \-
chr21 10120573  10120796  uc002yix.2 0  \-
.ft P
.fi
.SS 5.22 groupBy
.sp
\fBgroupBy\fP is a useful tool that mimics the "groupBy" clause in database systems. Given a file or stream
that is sorted by the appropriate "grouping columns", groupBy will compute summary statistics on
another column in the file or stream. This will work with output from all BEDTools as well as any other
tab\-delimited file or stream.
.sp
\fBNOTE: When using groupBy, the input data must be ordered by the same
columns as specified with the \-grp argument. For example, if \-grp is 1,2,3, the the
data should be pre\-grouped accordingly. When groupBy detects changes in the
group columns it then summarizes all lines with that group\fP.
.SS 5.22.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
groupBy [OPTIONS] \-i <input> \-opCol <input column>
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-i\fP
T}	T{
.INDENT 0.0
.INDENT 3.5
The input file that should be grouped and summarized. \fIUse "stdin" when using piped input\fP.
.UNINDENT
.UNINDENT
.sp
\fBNote: if \-i is omitted, input is assumed to come from standard input (stdin)\fP
T}
_
T{
\fB\-g OR \-grp\fP
T}	T{
Specifies which column(s) (1\-based) should be used to group the input. The columns must be comma\-separated and each column must be explicitly listed. No ranges (e.g. 1\-4) yet allowed. \fIDefault: 1,2,3\fP
T}
_
T{
\fB\-c OR \-opCol\fP
T}	T{
Specify the column (1\-based) that should be summarized. \fIRequired\fP.
T}
_
T{
\fB\-o OR \-op\fP
T}	T{
Specify the operation that should be applied to \fBopCol\fP.
.nf
Valid operations:
.fi
.sp
.INDENT 0.0
.INDENT 3.5
.nf
\fBsum\fP \- \fInumeric only\fP
\fBcount\fP \- \fInumeric or text\fP
\fBmin\fP \- \fInumeric only\fP
\fBmax\fP \- \fInumeric only\fP
\fBmean\fP \- \fInumeric only\fP
\fBstdev\fP \- \fInumeric only\fP
\fBmedian\fP \- \fInumeric only\fP
\fBmode\fP \- \fInumeric or text\fP
\fBantimode\fP \- \fInumeric or text\fP
\fBcollapse\fP (i.e., print a comma separated list) \- \fInumeric or text\fP
\fBfreqasc\fP \- \fIprint a comma separated list of values observed and the number of times they were observed. Reported in ascending order of frequency\fP
.fi
.sp
.UNINDENT
.UNINDENT
.nf
\fBfreqdesc\fP \- \fIprint a comma separated list of values observed and the number of times they were observed. Reported in descending order of frequency\fP
.fi
.sp
.INDENT 0.0
.INDENT 3.5
.nf
\fIDefault: sum\fP
.fi
.sp
.UNINDENT
.UNINDENT
T}
_
.TE
.SS 5.22.2 Default behavior.
.sp
Let\(aqs imagine we have three incredibly interesting genetic variants that we are studying and we are
interested in what annotated repeats these variants overlap.
.sp
.nf
.ft C
cat variants.bed
chr21  9719758 9729320 variant1
chr21  9729310 9757478 variant2
chr21  9795588 9796685 variant3

intersectBed \-a variants.bed \-b repeats.bed \-wa \-wb > variantsToRepeats.bed
cat variantsToRepeats.bed
chr21  9719758 9729320 variant1   chr21  9719768 9721892 ALR/Alpha   1004  +
chr21  9719758 9729320 variant1   chr21  9721905 9725582 ALR/Alpha   1010  +
chr21  9719758 9729320 variant1   chr21  9725582 9725977 L1PA3       3288  +
chr21  9719758 9729320 variant1   chr21  9726021 9729309 ALR/Alpha   1051  +
chr21  9729310 9757478 variant2   chr21  9729320 9729809 L1PA3       3897  \-
chr21  9729310 9757478 variant2   chr21  9729809 9730866 L1P1        8367  +
chr21  9729310 9757478 variant2   chr21  9730866 9734026 ALR/Alpha   1036  \-
chr21  9729310 9757478 variant2   chr21  9734037 9757471 ALR/Alpha   1182  \-
chr21  9795588 9796685 variant3   chr21  9795589 9795713 (GAATG)n    308   +
chr21  9795588 9796685 variant3   chr21  9795736 9795894 (GAATG)n    683   +
chr21  9795588 9796685 variant3   chr21  9795911 9796007 (GAATG)n    345   +
chr21  9795588 9796685 variant3   chr21  9796028 9796187 (GAATG)n    756   +
chr21  9795588 9796685 variant3   chr21  9796202 9796615 (GAATG)n    891   +
chr21  9795588 9796685 variant3   chr21  9796637 9796824 (GAATG)n    621   +
.ft P
.fi
.sp
We can see that variant1 overlaps with 3 repeats, variant2 with 4 and variant3 with 6. We can use
groupBy to summarize the hits for each variant in several useful ways. The default behavior is to
compute the \fIsum\fP of the opCol.
.sp
.nf
.ft C
groupBy \-i variantsToRepeats.bed \-grp 1,2,3 \-opCol 9
chr21 9719758 9729320 6353
chr21 9729310 9757478 14482
chr21 9795588 9796685 3604
.ft P
.fi
.SS 5.22.3 Computing the min and max.
.sp
Now let\(aqs find the \fImin\fP and \fImax\fP repeat score for each variant. We do this by "grouping" on the variant
coordinate columns (i.e. cols. 1,2 and 3) and ask for the min and max of the repeat score column (i.e.
col. 9).
.sp
.nf
.ft C
groupBy \-i variantsToRepeats.bed \-g 1,2,3 \-c 9 \-o min
chr21 9719758 9729320 1004
chr21 9729310 9757478 1036
chr21 9795588 9796685 308
.ft P
.fi
.sp
We can also group on just the \fIname\fP column with similar effect.
.sp
.nf
.ft C
groupBy \-i variantsToRepeats.bed \-grp 4 \-opCol 9 \-op min
variant1 1004
variant2 1036
variant3 308
.ft P
.fi
.sp
What about the \fImax\fP score? Let\(aqs keep the coordinates and the name of the variants so that we
stay in BED format.
.sp
.nf
.ft C
groupBy \-i variantsToRepeats.bed \-grp 1,2,3,4 \-opCol 9 \-op max
chr21 9719758 9729320 variant1 3288
chr21 9729310 9757478 variant2 8367
chr21 9795588 9796685 variant3 891
.ft P
.fi
.SS 5.22.4 Computing the mean and median.
.sp
Now let\(aqs find the \fImean\fP and \fImedian\fP repeat score for each variant.
.sp
.nf
.ft C
cat variantsToRepeats.bed | groupBy \-g 1,2,3,4 \-c 9 \-o mean
chr21 9719758 9729320 variant1 1588.25
chr21 9729310 9757478 variant2 3620.5
chr21 9795588 9796685 variant3 600.6667

groupBy \-i variantsToRepeats.bed \-grp 1,2,3,4 \-opCol 9 \-op median
chr21 9719758 9729320 variant1 1030.5
chr21 9729310 9757478 variant2 2539.5
chr21 9795588 9796685 variant3 652
.ft P
.fi
.SS 5.22.5 Computing the mode and "antimode".
.sp
Now let\(aqs find the \fImode\fP and \fIantimode\fP (i.e., the least frequent) repeat score for each variant (in this case
they are identical).
.sp
.nf
.ft C
groupBy \-i variantsToRepeats.bed \-grp 1,2,3,4 \-opCol 9 \-op mode
chr21 9719758 9729320 variant1 1004
chr21 9729310 9757478 variant2 1036
chr21 9795588 9796685 variant3 308

groupBy \-i variantsToRepeats.bed \-grp 1,2,3,4 \-opCol 9 \-op antimode
chr21 9719758 9729320 variant1 1004
chr21 9729310 9757478 variant2 1036
chr21 9795588 9796685 variant3 308
.ft P
.fi
.SS 5.22.6 Computing the count of lines for a given group.
.sp
Figure:
.sp
.nf
.ft C
groupBy \-i variantsToRepeats.bed \-g 1,2,3,4 \-c 9 \-c count
chr21 9719758 9729320 variant1 4
chr21 9729310 9757478 variant2 4
chr21 9795588 9796685 variant3 6
.ft P
.fi
.SS 5.22.7 Collapsing: listing all of the values in the opCol for a given group.
.sp
Now for something different. What if we wanted all of the names of the repeats listed on the same line
as the variants? Use the collapse option. This "denormalizes" things. Now you have a list of all the
repeats on a single line.
.sp
.nf
.ft C
groupBy \-i variantsToRepeats.bed \-grp 1,2,3,4 \-opCol 9 \-op collapse
chr21 9719758 9729320 variant1 ALR/Alpha,ALR/Alpha,L1PA3,ALR/Alpha,
chr21 9729310 9757478 variant2 L1PA3,L1P1,ALR/Alpha,ALR/Alpha,
chr21 9795588 9796685 variant3 (GAATG)n,(GAATG)n,(GAATG)n,(GAATG)n,(GAATG)n,(GAATG)n,
.ft P
.fi
.SS 5.22.8 Computing frequencies: freqasc and freqdesc.
.sp
Now for something different. What if we wanted all of the names of the repeats listed on the same line
as the variants? Use the collapse option. This "denormalizes" things. Now you have a list of all the
repeats on a single line.
.sp
.nf
.ft C
cat variantsToRepeats.bed | groupBy \-g 1 \-c 8 \-o freqdesc
chr21 (GAATG)n:6,ALR/Alpha:5,L1PA3:2,L1P1:1,

cat variantsToRepeats.bed | groupBy \-g 1 \-c 8 \-o freqasc
chr21 L1P1:1,L1PA3:2,ALR/Alpha:5,(GAATG)n:6,
.ft P
.fi
.SS 5.23 unionBedGraphs
.sp
\fBunionBedGraphs\fP combines multiple BEDGRAPH files into a single file such that one can directly
compare coverage (and other text\-values such as genotypes) across multiple sample
.SS 5.23.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
unionBedGraphs [OPTIONS] \-i FILE1 FILE2 FILE3 ... FILEn
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-header\fP
T}	T{
Print a header line, consisting of chrom, start, end followed by the names of each input BEDGRAPH file.
T}
_
T{
\fB\-names\fP
T}	T{
A list of names (one per file) to describe each file in \-i. These names will be printed in the header line.
T}
_
T{
\fB\-empty\fP
T}	T{
Report empty regions (i.e., start/end intervals w/o values in all files). \fIRequires the \(aq\-g FILE\(aq parameter (see below)\fP.
T}
_
T{
\fB\-g\fP
T}	T{
The genome file to be used to calculate empty regions.
T}
_
T{
\fB\-filler TEXT\fP
T}	T{
Use TEXT when representing intervals having no value. Default is \(aq0\(aq, but you can use \(aqN/A\(aq or any other text.
T}
_
T{
\fB\-examples\fP
T}	T{
Show detailed usage examples.
T}
_
.TE
.SS 5.23.2 Default behavior
.sp
Figure:
.sp
.nf
.ft C
cat 1.bg
chr1 1000 1500 10
chr1 2000 2100 20

cat 2.bg
chr1 900 1600 60
chr1 1700 2050 50

cat 3.bg
chr1 1980 2070 80
chr1 2090 2100 20

cat sizes.txt
chr1 5000

unionBedGraphs \-i 1.bg 2.bg 3.bg
chr1 900  1000 0  60 0
chr1 1000 1500 10 60 0
chr1 1500 1600 0  60 0
chr1 1700 1980 0  50 0
chr1 1980 2000 0  50 80
chr1 2000 2050 20 50 80
chr1 2050 2070 20 0  80
chr1 2070 2090 20 0  0
chr1 2090 2100 20 0  20
.ft P
.fi
.SS 5.23.3 Add a header line to the output
.sp
Figure:
.sp
.nf
.ft C
unionBedGraphs \-i 1.bg 2.bg 3.bg \-header
chrom  start  end  1  2  3
chr1   900    1000 0  60 0
chr1   1000   1500 10 60 0
chr1   1500   1600 0  60 0
chr1   1700   1980 0  50 0
chr1   1980   2000 0  50 80
chr1   2000   2050 20 50 80
chr1   2050   2070 20 0  80
chr1   2070   2090 20 0  0
chr1   2090   2100 20 0  20
.ft P
.fi
.SS 5.23.4 Add a header line with custom file names to the output
.sp
Figure:
.sp
.nf
.ft C
unionBedGraphs \-i 1.bg 2.bg 3.bg \-header \-names WT\-1 WT\-2 KO\-1
chrom  start  end   WT\-1  WT\-2  KO\-1
chr1   900    1000  0     60    0
chr1   1000   1500  10    60    0
chr1   1500   1600  0     60    0
chr1   1700   1980  0     50    0
chr1   1980   2000  0     50    80
chr1   2000   2050  20    50    80
chr1   2050   2070  20    0     80
chr1   2070   2090  20    0     0
chr1   2090   2100  20    0     20
.ft P
.fi
.SS 5.23.5 Include regions that have zero coverage in all BEDGRAPH files.
.sp
Figure:
.sp
.nf
.ft C
unionBedGraphs \-i 1.bg 2.bg 3.bg \-empty \-g sizes.txt \-header
chrom  start  end  WT\-1  WT\-2  KO\-1
chrom  start  end  1     2     3
chr1   0      900  0     0     0
chr1   900    1000 0     60    0
chr1   1000   1500 10    60    0
chr1   1500   1600 0     60    0
chr1   1600   1700 0     0     0
chr1   1700   1980 0     50    0
chr1   1980   2000 0     50    80
chr1   2000   2050 20    50    80
chr1   2050   2070 20    0     80
chr1   2070   2090 20    0     0
chr1   2090   2100 20    0     20
chr1   2100   5000 0     0     0
.ft P
.fi
.SS 5.23.6 Use a custom value for missing values.
.sp
Figure:
.sp
.nf
.ft C
unionBedGraphs \-i 1.bg 2.bg 3.bg \-empty \-g sizes.txt \-header \-filler N/A
chrom start end  WT\-1  WT\-2  KO\-1
chrom start end  1     2     3
chr1  0     900  N/A   N/A   N/A
chr1  900   1000 N/A   60    N/A
chr1  1000  1500 10    60    N/A
chr1  1500  1600 N/A   60    N/A
chr1  1600  1700 N/A   N/A   N/A
chr1  1700  1980 N/A   50    N/A
chr1  1980  2000 N/A   50    80
chr1  2000  2050 20    50    80
chr1  2050  2070 20    N/A   80
chr1  2070  2090 20    N/A   N/A
chr1  2090  2100 20    N/A   20
chr1  2100  5000 N/A   N/A   N/A
.ft P
.fi
.SS 5.23.7 Use BEDGRAPH files with non\-numeric values.
.sp
Figure:
.sp
.nf
.ft C
cat 1.snp.bg
chr1 0 1 A/G
chr1 5 6 C/T

cat 2.snp.bg
chr1 0 1 C/C
chr1 7 8 T/T

cat 3.snp.bg
chr1 0 1 A/G
chr1 5 6 C/T

unionBedGraphs \-i 1.snp.bg 2.snp.bg 3.snp.bg \-filler \-/\-
chr1 0 1 A/G C/C A/G
chr1 5 6 C/T \-/\- C/T
chr1 7 8 \-/\- T/T \-/\-
.ft P
.fi
.SS 5.24 annotateBed
.sp
\fBannotateBed\fP annotates one BED/VCF/GFF file with the coverage and number of overlaps observed
from multiple other BED/VCF/GFF files. In this way, it allows one to ask to what degree one feature
coincides with multiple other feature types with a single command.
.SS 5.24.1 Usage and option summary
.sp
Usage:
.sp
.nf
.ft C
annotateBed [OPTIONS] \-i <BED/GFF/VCF> \-files FILE1 FILE2 FILE3 ... FILEn
.ft P
.fi
.TS
center;
|l|l|.
_
T{
Option
T}	T{
Description
T}
_
T{
\fB\-namesr\fP
T}	T{
A list of names (one per file) to describe each file in \-i. These names will be printed as a header line.
T}
_
T{
\fB\-counts\fP
T}	T{
Report the count of features in each file that overlap \-i. Default behavior is to report the fraction of \-i covered by each file.
T}
_
T{
\fB\-both\fP
T}	T{
Report the count of features followed by the % coverage for each annotation file. Default is to report solely the fraction of \-i covered by each file.
T}
_
T{
\fB\-s\fP
T}	T{
Force strandedness. That is, only include hits in A that overlap B on the same strand. By default, hits are included without respect to strand.
T}
_
.TE
.SS 5.24.2 Default behavior \- annotate one file with coverage from others.
.sp
By default, the fraction of each feature covered by each annotation file is reported after the complete
feature in the file to be annotated.
.sp
.nf
.ft C
cat variants.bed
chr1 100  200   nasty 1  \-
chr2 500  1000  ugly  2  +
chr3 1000 5000  big   3  \-

cat genes.bed
chr1 150  200   geneA 1  +
chr1 175  250   geneB 2  +
chr3 0    10000 geneC 3  \-

cat conserve.bed
chr1 0    10000 cons1 1  +
chr2 700  10000 cons2 2  \-
chr3 4000 10000 cons3 3  +

cat known_var.bed
chr1 0    120   known1   \-
chr1 150  160   known2   \-
chr2 0    10000 known3   +

annotateBed \-i variants.bed \-files genes.bed conserv.bed known_var.bed
chr1 100  200  nasty 1 \-  0.500000  1.000000  0.300000
chr2 500  1000 ugly  2 +  0.000000  0.600000  1.000000
chr3 1000 5000 big   3 \-  1.000000  0.250000  0.000000
.ft P
.fi
.SS 5.24.3 Report the count of hits from the annotation files
.sp
Figure:
.sp
.nf
.ft C
annotateBed \-counts \-i variants.bed \-files genes.bed conserv.bed known_var.bed
chr1 100  200  nasty 1 \- 2 1 2
chr2 500  1000 ugly  2 + 0 1 1
chr3 1000 5000 big   3 \- 1 1 0
.ft P
.fi
.SS 5.24.4 Report both the count of hits and the fraction covered from the annotation files
.sp
Figure:
.sp
.nf
.ft C
annotateBed \-both \-i variants.bed \-files genes.bed conserv.bed known_var.bed
#chr start end  name  score +/\-  cnt1 pct1     cnt2 pct2     cnt3 pct3
chr1 100   200  nasty 1     \-    2    0.500000 1    1.000000 2    0.300000
chr2 500   1000 ugly  2     +    0    0.000000 1    0.600000 1    1.000000
chr3 1000  5000 big   3     \-    1    1.000000 1    0.250000 0    0.000000
.ft P
.fi
.SS 5.24.5 Restrict the reporting to overlaps on the same strand.
.sp
Note: Compare with the result from 5.24.3
.sp
.nf
.ft C
annotateBed \-s \-i variants.bed \-files genes.bed conserv.bed known_var.bed
chr1  100   200   nasty  var1  \-  0.000000  0.000000  0.000000
chr2  500   1000  ugly   var2  +  0.000000  0.000000  0.000000
chr3  1000  5000  big    var3  \-  1.000000  0.000000  0.000000
.ft P
.fi
.SH EXAMPLE USAGE
.sp
Below are several examples of basic BEDTools usage. Example BED files are provided in the
/data directory of the BEDTools distribution.
.SS 6.1 intersectBed
.sp
6.1.1 Report the base\-pair overlap between sequence alignments and genes.
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed
.ft P
.fi
.sp
6.1.2 Report whether each alignment overlaps one or more genes. If not, the alignment is not reported.
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed \-u
.ft P
.fi
.sp
6.1.3 Report those alignments that overlap NO genes. Like "grep \-v"
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed \-v
.ft P
.fi
.sp
6.1.4 Report the number of genes that each alignment overlaps.
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed \-c
.ft P
.fi
.sp
6.1.5 Report the entire, original alignment entry for each overlap with a gene.
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed \-wa
.ft P
.fi
.sp
6.1.6 Report the entire, original gene entry for each overlap with a gene.
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed \-wb
.ft P
.fi
.sp
6.1.7 Report the entire, original alignment and gene entries for each overlap.
.sp
.nf
.ft C
intersectBed \-a reads.bed \-b genes.bed \-wa \-wb
.ft P
.fi
.sp
6.1.8 Only report an overlap with a repeat if it spans at least 50% of the exon.
.sp
.nf
.ft C
intersectBed \-a exons.bed \-b repeatMasker.bed \-f 0.50
.ft P
.fi
.sp
6.1.9 Only report an overlap if comprises 50% of the structural variant and 50% of the segmental duplication. Thus, it is reciprocally at least a 50% overlap.
.sp
.nf
.ft C
intersectBed \-a SV.bed \-b segmentalDups.bed \-f 0.50 \-r
.ft P
.fi
.sp
6.1.10 Read BED A from stdin. For example, find genes that overlap LINEs but not SINEs.
.sp
.nf
.ft C
intersectBed \-a genes.bed \-b LINES.bed | intersectBed \-a stdin \-b SINEs.bed \-v
.ft P
.fi
.sp
6.1.11 Retain only single\-end BAM alignments that overlap exons.
.sp
.nf
.ft C
intersectBed \-abam reads.bam \-b exons.bed > reads.touchingExons.bam
.ft P
.fi
.sp
6.1.12 Retain only single\-end BAM alignments that do not overlap simple sequence
repeats.
.sp
.nf
.ft C
intersectBed \-abam reads.bam \-b SSRs.bed \-v > reads.noSSRs.bam
.ft P
.fi
.SS 6.2 pairToBed
.sp
6.2.1 Return all structural variants (in BEDPE format) that overlap with genes on either
end.
.sp
.nf
.ft C
pairToBed \-a sv.bedpe \-b genes > sv.genes
.ft P
.fi
.sp
6.2.2 Return all structural variants (in BEDPE format) that overlap with genes on both
end.
.sp
.nf
.ft C
pairToBed \-a sv.bedpe \-b genes \-type both > sv.genes
.ft P
.fi
.sp
6.2.3 Retain only paired\-end BAM alignments where neither end overlaps simple
sequence repeats.
.sp
.nf
.ft C
pairToBed \-abam reads.bam \-b SSRs.bed \-type neither > reads.noSSRs.bam
.ft P
.fi
.sp
6.2.4 Retain only paired\-end BAM alignments where both ends overlap segmental
duplications.
.sp
.nf
.ft C
pairToBed \-abam reads.bam \-b segdups.bed \-type both > reads.SSRs.bam
.ft P
.fi
.sp
6.2.5 Retain only paired\-end BAM alignments where neither or one and only one end
overlaps segmental duplications.
.sp
.nf
.ft C
pairToBed \-abam reads.bam \-b segdups.bed \-type notboth > reads.notbothSSRs.bam
.ft P
.fi
.SS 6.3 pairToPair
.sp
6.3.1 Find all SVs (in BEDPE format) in sample 1 that are also in sample 2.
.sp
.nf
.ft C
pairToPair \-a 1.sv.bedpe \-b 2.sv.bedpe | cut \-f 1\-10 > 1.sv.in2.bedpe
.ft P
.fi
.sp
6.3.2 Find all SVs (in BEDPE format) in sample 1 that are not in sample 2.
.sp
.nf
.ft C
pairToPair \-a 1.sv.bedpe \-b 2.sv.bedpe \-type neither | cut \-f 1\-10 >
.ft P
.fi
.sp
1.sv.notin2.bedpe
.SS 6.4 bamToBed
.sp
6.4.1 Convert BAM alignments to BED format.
.sp
.nf
.ft C
bamToBed \-i reads.bam > reads.bed
.ft P
.fi
.sp
6.4.2 Convert BAM alignments to BED format using the BAM edit distance (NM) as the
BED "score".
.sp
.nf
.ft C
bamToBed \-i reads.bam \-ed > reads.bed
.ft P
.fi
.sp
6.4.3 Convert BAM alignments to BEDPE format.
.sp
.nf
.ft C
bamToBed \-i reads.bam \-bedpe > reads.bedpe
.ft P
.fi
.SS 6.5 windowBed
.sp
6.5.1 Report all genes that are within 10000 bp upstream or downstream of CNVs.
.sp
.nf
.ft C
windowBed \-a CNVs.bed \-b genes.bed \-w 10000
.ft P
.fi
.sp
6.5.2 Report all genes that are within 10000 bp upstream or 5000 bp downstream of
CNVs.
.sp
.nf
.ft C
windowBed \-a CNVs.bed \-b genes.bed \-l 10000 \-r 5000
.ft P
.fi
.sp
6.5.3 Report all SNPs that are within 5000 bp upstream or 1000 bp downstream of genes.
Define upstream and downstream based on strand.
.sp
.nf
.ft C
windowBed \-a genes.bed \-b snps.bed \-l 5000 \-r 1000 \-sw
.ft P
.fi
.SS 6.6 closestBed
.sp
Note: By default, if there is a tie for closest, all ties will be reported. \fBclosestBed\fP allows overlapping
features to be the closest.
.sp
6.6.1 Find the closest ALU to each gene.
.sp
.nf
.ft C
closestBed \-a genes.bed \-b ALUs.bed
.ft P
.fi
.sp
6.6.2 Find the closest ALU to each gene, choosing the first ALU in the file if there is a
tie.
.sp
.nf
.ft C
closestBed \-a genes.bed \-b ALUs.bed \-t first
.ft P
.fi
.sp
6.6.3 Find the closest ALU to each gene, choosing the last ALU in the file if there is a
tie.
.sp
.nf
.ft C
closestBed \-a genes.bed \-b ALUs.bed \-t last
.ft P
.fi
.SS 6.7 subtractBed
.sp
Note: If a feature in A is entirely "spanned" by any feature in B, it will not be reported.
.sp
6.7.1 Remove introns from gene features. Exons will (should) be reported.
.sp
.nf
.ft C
subtractBed \-a genes.bed \-b introns.bed
.ft P
.fi
.SS 6.8 mergeBed
.sp
6.8.1 Merge overlapping repetitive elements into a single entry.
.sp
.nf
.ft C
mergeBed \-i repeatMasker.bed
.ft P
.fi
.sp
6.8.2 Merge overlapping repetitive elements into a single entry, returning the number of
entries merged.
.sp
.nf
.ft C
mergeBed \-i repeatMasker.bed \-n
.ft P
.fi
.sp
6.8.3 Merge nearby (within 1000 bp) repetitive elements into a single entry.
.sp
.nf
.ft C
mergeBed \-i repeatMasker.bed \-d 1000
.ft P
.fi
.SS 6.9 coverageBed
.sp
6.9.1 Compute the coverage of aligned sequences on 10 kilobase "windows" spanning the
genome.
.sp
.nf
.ft C
coverageBed \-a reads.bed \-b windows10kb.bed | head
chr1 0     10000 0  10000 0.00
chr1 10001 20000 33 10000 0.21
chr1 20001 30000 42 10000 0.29
chr1 30001 40000 71 10000 0.36
.ft P
.fi
.sp
6.9.2 Compute the coverage of aligned sequences on 10 kilobase "windows" spanning the
genome and created a BEDGRAPH of the number of aligned reads in each window for
display on the UCSC browser.
.sp
.nf
.ft C
coverageBed \-a reads.bed \-b windows10kb.bed | cut \-f 1\-4 > windows10kb.cov.bedg
.ft P
.fi
.sp
6.9.3 Compute the coverage of aligned sequences on 10 kilobase "windows" spanning the
genome and created a BEDGRAPH of the fraction of each window covered by at least
one aligned read for display on the UCSC browser.
.sp
.nf
.ft C
coverageBed \-a reads.bed \-b windows10kb.bed | awk ??{OFS="\et"; print $1,$2,$3,$6}??
> windows10kb.pctcov.bedg
.ft P
.fi
.SS 6.10 complementBed
.sp
6.10.1 Report all intervals in the human genome that are not covered by repetitive
elements.
.sp
.nf
.ft C
complementBed \-i repeatMasker.bed \-g hg18.genome
.ft P
.fi
.SS 6.11 shuffleBed
.sp
6.11.1 Randomly place all discovered variants in the genome. However, prevent them
from being placed in know genome gaps.
.sp
.nf
.ft C
shuffleBed \-i variants.bed \-g hg18.genome \-excl genome_gaps.bed
.ft P
.fi
.sp
6.11.2 Randomly place all discovered variants in the genome. However, prevent them
from being placed in know genome gaps and require that the variants be randomly
placed on the same chromosome.
.sp
.nf
.ft C
shuffleBed \-i variants.bed \-g hg18.genome \-excl genome_gaps.bed \-chrom
.ft P
.fi
.SH ADVANCED USAGE
.SS 7.1 Mask all regions in a genome except for targeted capture regions.
.sp
# Add 500 bp up and downstream of each probe
.sp
.nf
.ft C
slopBed \-i probes.bed \-b 500 > probes.500bp.bed
.ft P
.fi
.sp
# Get a BED file of all regions not covered by the probes (+500 bp up/down)
.sp
.nf
.ft C
complementBed \-i probes.500bp.bed \-g hg18.genome > probes.500bp.complement.bed
.ft P
.fi
.sp
# Create a masked genome where all bases are masked except for the probes +500bp
.sp
.nf
.ft C
maskFastaFromBed \-in hg18.fa \-bed probes.500bp.complement.bed \-fo hg18.probecomplement.
masked.fa
.ft P
.fi
.SS 7.2 Screening for novel SNPs.
.sp
# Find all SNPs that are not in dbSnp and not in the latest 1000 genomes calls
.sp
.nf
.ft C
intersectBed \-a snp.calls.bed \-b dbSnp.bed \-v | intersectBed \-a stdin \-b 1KG.bed
\-v > snp.calls.novel.bed
.ft P
.fi
.sp
you can first use intersectBed with the "\-f 1.0" option.
.sp
.nf
.ft C
intersectBed \-a features.bed \-b windows.bed \-f 1.0 | coverageBed \-a stdin \-b
windows.bed > windows.bed.coverage
.ft P
.fi
.SS 7.4 Computing the coverage of BAM alignments on exons.
.sp
# One can combine SAMtools with BEDtools to compute coverage directly from the BAM
data by using bamToBed.
.sp
.nf
.ft C
bamToBed \-i reads.bam | coverageBed \-a stdin \-b exons.bed > exons.bed.coverage
.ft P
.fi
.sp
# Take it a step further and require that coverage be from properly\-paired reads.
.sp
.nf
.ft C
samtools view \-bf 0x2 reads.bam | bamToBed \-i stdin | coverageBed \-a stdin \-b
exons.bed > exons.bed.proper.coverage
.ft P
.fi
.SS 7.5 Computing coverage separately for each strand.
.sp
# Use grep to only look at forward strand features (i.e. those that end in "+").
.sp
.nf
.ft C
bamToBed \-i reads.bam | grep \e+$ | coverageBed \-a stdin \-b genes.bed >
genes.bed.forward.coverage
.ft P
.fi
.sp
# Use grep to only look at reverse strand features (i.e. those that end in "\-").
.sp
.nf
.ft C
bamToBed \-i reads.bam | grep \e\-$ | coverageBed \-a stdin \-b genes.bed >
genes.bed.forward.coverage
.ft P
.fi
.SS 7.6 Find structural variant calls that are private to one sample.
.sp
# :
.sp
.nf
.ft C
pairToPair \-a sample1.sv.bedpe \-b othersamples.sv.bedpe \-type neither >
sample1.sv.private.bedpe
.ft P
.fi
.SS 7.7 Exclude SV deletions that appear to be ALU insertions in the reference genome.
.sp
# We\(aqll require that 90% of the inner span of the deletion be overlapped by a
recent ALU.
.sp
.nf
.ft C
pairToBed \-a deletions.sv.bedpe \-b ALUs.recent.bed \-type notispan \-f 0.80 >
deletions.notALUsinRef.bedpe
.ft P
.fi
.sp
Refer to the mailing list.
.SH AUTHOR
UVa
.SH COPYRIGHT
2012
.\" Generated by docutils manpage writer.
.\" 
.
