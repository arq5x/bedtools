

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5.4 bamToBed</title>
    
    <link rel="stylesheet" href="../_static/rtd.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.16.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/bedtools.png"/>
    <link rel="top" title="None" href="../index.html" />
    <link rel="up" title="The BEDTools suite" href="bedtools-suite.html" />
    <link rel="next" title="5.5 windowBed" href="windowBed.html" />
    <link rel="prev" title="5.3 pairToPair" href="pairToPair.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="windowBed.html" title="5.5 windowBed"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pairToPair.html" title="5.3 pairToPair"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">bedtools v2.16.2</a> &raquo;</li>
          <li><a href="bedtools-suite.html" accesskey="U">The BEDTools suite</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="bamtobed">
<h1>5.4 bamToBed<a class="headerlink" href="#bamtobed" title="Permalink to this headline">¶</a></h1>
<p><strong>bamToBed</strong> is a general purpose tool that will convert sequence alignments in BAM format to either
BED6, BED12 or BEDPE format. This enables one to convert BAM files for use with all of the other
BEDTools. The CIGAR string is used to compute the alignment end coordinate in an &#8220;ungapped&#8221;
fashion. That is, match (&#8220;M&#8221;), deletion (&#8220;D&#8221;), and splice (&#8220;N&#8221;) operations are observed when computing
alignment ends.</p>
<div class="section" id="usage-and-option-summary">
<h2>5.4.1 Usage and option summary<a class="headerlink" href="#usage-and-option-summary" title="Permalink to this headline">¶</a></h2>
<p><strong>Usage:</strong></p>
<div class="highlight-python"><pre>bamToBed [OPTIONS] -i &lt;BAM&gt;</pre>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="3%" />
<col width="97%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>-bedpe</strong></td>
<td><blockquote class="first">
<div><dl class="docutils">
<dt>Write BAM alignments in BEDPE format. Only one alignment from paired-end reads will be reported. Specifically, it each mate is aligned to the same chromosome, the BAM alignment reported will be the one where the BAM insert size is greater than zero. When the mate alignments are interchromosomal, the lexicographically lower chromosome will be reported first. Lastly, when an end is unmapped, the chromosome and strand will be set to &#8221;.&#8221; and the start and end coordinates will be set to -1. <em>By default, this is disabled and the output will be reported in BED format</em>.</dt>
<dd><strong>NOTE: When using this option, it is required that the BAM file is sorted/grouped by the read name. This allows bamToBed to extract correct alignment coordinates for each end based on their respective CIGAR strings. It also assumes that the alignments for a given pair come in groups of twos. There is not yet a standard method for reporting multiple alignments using BAM. bamToBed will fail if an aligner does not report alignments in pairs</strong>.</dd>
</dl>
</div></blockquote>
<p class="last">BAM files may be piped to bamToBed by specifying &#8220;-i stdin&#8221;. See example below.</p>
</td>
</tr>
<tr class="row-odd"><td><strong>-bed12</strong></td>
<td>Write &#8220;blocked&#8221; BED (a.k.a. BED12) format. This will convert &#8220;spliced&#8221; BAM alignments (denoted by the &#8220;N&#8221; CIGAR operation) to BED12.</td>
</tr>
<tr class="row-even"><td><strong>-ed</strong></td>
<td>Use the &#8220;edit distance&#8221; tag (NM) for the BED score field. Default for BED is to use mapping quality. Default for BEDPE is to use the <em>minimum</em> of the two mapping qualities for the pair. When -ed is used with -bedpe, the total edit distance from the two mates is reported.</td>
</tr>
<tr class="row-odd"><td><strong>-tag</strong></td>
<td>Use other <em>numeric</em> BAM alignment tag for BED score. Default for BED is to use mapping quality. Disallowed with BEDPE output.</td>
</tr>
<tr class="row-even"><td><strong>-color</strong></td>
<td>An R,G,B string for the color used with BED12 format. Default is (255,0,0).</td>
</tr>
<tr class="row-odd"><td><strong>-split</strong></td>
<td>Report each portion of a &#8220;split&#8221; BAM (i.e., having an &#8220;N&#8221; CIGAR operation) alignment as a distinct BED intervals.</td>
</tr>
</tbody>
</table>
<p>By default, each alignment in the BAM file is converted to a 6 column BED. The BED &#8220;name&#8221; field is
comprised of the RNAME field in the BAM alignment. If mate information is available, the mate (e.g.,
&#8220;/1&#8221; or &#8220;/2&#8221;) field will be appended to the name. The &#8220;score&#8221; field is the mapping quality score from the
BAM alignment, unless the <strong>-ed</strong> option is used.</p>
<p>Examples:</p>
<div class="highlight-python"><pre>bamToBed -i reads.bam | head -5
chr7   118970079   118970129   TUPAC_0001:3:1:0:1452#0/1   37   -
chr7   118965072   118965122   TUPAC_0001:3:1:0:1452#0/2   37   +
chr11  46769934    46769984    TUPAC_0001:3:1:0:1472#0/1   37   -

bamToBed -i reads.bam -tag NM | head -5
chr7   118970079   118970129   TUPAC_0001:3:1:0:1452#0/1   1    -
chr7   118965072   118965122   TUPAC_0001:3:1:0:1452#0/2   3    +
chr11  46769934    46769984    TUPAC_0001:3:1:0:1472#0/1   1    -

bamToBed -i reads.bam -bedpe | head -3
chr7   118965072   118965122   chr7   118970079   118970129
       TUPAC_0001:3:1:0:1452#0 37     +     -
chr11  46765606    46765656    chr11  46769934    46769984
       TUPAC_0001:3:1:0:1472#0 37     +     -
chr20  54704674    54704724    chr20  54708987    54709037
       TUPAC_0001:3:1:1:1833#0 37     +</pre>
</div>
<p>One can easily use samtools and bamToBed together as part of a UNIX pipe. In this example, we will
only convert properly-paired (BAM flag == 0x2) reads to BED format.</p>
<div class="highlight-python"><pre>samtools view -bf 0x2 reads.bam | bamToBed -i stdin | head
chr7   118970079   118970129   TUPAC_0001:3:1:0:1452#0/1   37   -
chr7   118965072   118965122   TUPAC_0001:3:1:0:1452#0/2   37   +
chr11  46769934    46769984    TUPAC_0001:3:1:0:1472#0/1   37   -
chr11  46765606    46765656    TUPAC_0001:3:1:0:1472#0/2   37   +
chr20  54704674    54704724    TUPAC_0001:3:1:1:1833#0/1   37   +
chr20  54708987    54709037    TUPAC_0001:3:1:1:1833#0/2   37   -
chrX   9380413     9380463     TUPAC_0001:3:1:1:285#0/1    0    -
chrX   9375861     9375911     TUPAC_0001:3:1:1:285#0/2    0    +
chrX   131756978   131757028   TUPAC_0001:3:1:2:523#0/1    37   +
chrX   131761790   131761840   TUPAC_0001:3:1:2:523#0/2    37   -</pre>
</div>
</div>
<div class="section" id="split-creating-bed12-features-from-spliced-bam-entries">
<h2>5.4.2 (-split)Creating BED12 features from &#8220;spliced&#8221; BAM entries.<a class="headerlink" href="#split-creating-bed12-features-from-spliced-bam-entries" title="Permalink to this headline">¶</a></h2>
<p>bamToBed will, by default, create a BED6 feature that represents the entire span of a spliced/split
BAM alignment. However, when using the <strong>-split</strong> command, a BED12 feature is reported where BED
blocks will be created for each aligned portion of the sequencing read.</p>
<div class="highlight-python"><pre>Chromosome  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Exons       ***************                                    **********

BED/BAM A      ^^^^^^^^^^^^....................................^^^^

Result      ===============                                    ====</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/bedtools.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.4 bamToBed</a><ul>
<li><a class="reference internal" href="#usage-and-option-summary">5.4.1 Usage and option summary</a></li>
<li><a class="reference internal" href="#split-creating-bed12-features-from-spliced-bam-entries">5.4.2 (-split)Creating BED12 features from &#8220;spliced&#8221; BAM entries.</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="pairToPair.html"
                        title="previous chapter">5.3 pairToPair</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="windowBed.html"
                        title="next chapter">5.5 windowBed</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/content/bamToBed.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="windowBed.html" title="5.5 windowBed"
             >next</a> |</li>
        <li class="right" >
          <a href="pairToPair.html" title="5.3 pairToPair"
             >previous</a> |</li>
        <li><a href="../index.html">bedtools v2.16.2</a> &raquo;</li>
          <li><a href="bedtools-suite.html" >The BEDTools suite</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012.
      Last updated on Jul 23, 2012.
    <a href="http://www.gnu.org/licenses/gpl-3.0.txt"><p>GPL3 licensed</p></a>
    </div>
  </body>
</html>